/*!
 * ====================================================
 * kityminder-editor - v1.0.64 - 2019-04-10
 * https://github.com/fex-team/kityminder-editor
 * GitHub: https://github.com/fex-team/kityminder-editor 
 * Copyright (c) 2019 ; Licensed 
 * ====================================================
 */


!function(){var e={r:function(t){if(e[t].inited)return e[t].value;if("function"!=typeof e[t].value)return e[t].inited=!0,e[t].value;var n={exports:{}},i=e[t].value(null,n.exports,n);if(e[t].inited=!0,e[t].value=i,void 0!==i)return i;for(var r in n.exports)if(n.exports.hasOwnProperty(r))return e[t].inited=!0,e[t].value=n.exports,n.exports}};e[0]={value:function(t,n,i){var r=[];function o(e){r.push(e)}function a(t,n){this.selector=t,this.lang=e.r(3),void 0!==n&&this.lang.setDefaultLang(n);for(var i=0;i<r.length;i++)"function"==typeof r[i]&&r[i].call(this,this)}return a.assemble=o,o(e.r(7)),o(e.r(9)),o(e.r(14)),o(e.r(18)),o(e.r(11)),o(e.r(12)),o(e.r(5)),o(e.r(6)),o(e.r(8)),o(e.r(15)),o(e.r(10)),o(e.r(13)),o(e.r(16)),o(e.r(17)),i.exports=a}},e[1]={value:function(t,n,i){return i.exports=kityminder.Editor=e.r(0)}},e[2]={value:function(e,t,n){return n.exports=window.HotBox}},e[3]={value:function(t,n,i){var r={en:e.r(26),de:e.r(25),fr:e.r(27),zh_CN:e.r(28),zh_TW:e.r(29)},o="en";return i.exports={setDefaultLang:function(e){return void 0!==r[e]&&(o=e,!0)},t:function(e,t,n){void 0===n&&(n=o);var i=r[n];return void 0===i&&(i=r.en),t.split("/").forEach(function(e,t){i=i[e]}),null==i?e:i[e]||e}}}},e[4]={value:function(e,t,n){return n.exports=window.kityminder.Minder}},e[5]={value:function(e,t,n){function i(){var e="\ufeff",t={"application/km":"￿"},n={"\ufeff":"SPLITOR","￿":"application/km"};function i(t,n){if(!this.isPureText(n)){if(!this.whichMimeType(n))throw new Error("unknow mimetype!");n=this.getPureText(n)}return!1===t?n:t+e+n}this.registMimeTypeProtocol=function(e,i){if(i&&n[i])throw new Error("sing has registed!");if(e&&t[e])throw new Error("mimetype has registed!");n[i]=e,t[e]=i},this.getMimeTypeProtocol=function(e,n){var r=t[e]||!1;return void 0===n?i.bind(this,r):i(r,n)},this.getSpitor=function(){return e},this.getMimeType=function(e){return void 0!==e?n[e]||null:t}}return i.prototype.isPureText=function(e){return!~e.indexOf(this.getSpitor())},i.prototype.getPureText=function(e){return this.isPureText(e)?e:e.split(this.getSpitor())[1]},i.prototype.whichMimeType=function(e){return this.isPureText(e)?null:this.getMimeType(e.split(this.getSpitor())[0])},n.exports=function(){this.minder.supportClipboardEvent&&!kity.Browser.gecko&&(this.MimeType=new i)}}},e[6]={value:function(e,t,n){return n.exports=function(){var e=this.minder,t=window.kityminder.data;if(e.supportClipboardEvent&&!kity.Browser.gecko){var n=this.fsm,i=this.receiver,r=this.MimeType,o=r.getMimeTypeProtocol("application/km"),a=t.getRegisterProtocol("json").decode,l=[];document.addEventListener("copy",function(t){if(document.activeElement==i.element){var r=t;switch(n.state()){case"input":break;case"normal":var o=[].concat(e.getSelectedNodes());if(o.length){var a;if(o.length>1&&(o.sort(function(e,t){return e.getLevel()-t.getLevel()}),(a=o[0].getLevel())!==o[o.length-1].getLevel())){var l,d=0,c=o.length,u=c-1;for(l=o[u];l.getLevel()!==a;){for(d=0;d<c&&o[d].getLevel()===a;){if(o[d].isAncestorOf(l)){o.splice(u,1);break}d++}l=o[--u]}}var p=s(o);r.clipboardData.setData("text/plain",p)}t.preventDefault()}}}),document.addEventListener("cut",function(t){if(document.activeElement==i.element){if("normal"!==e.getStatus())return void t.preventDefault();var r=t;switch(n.state()){case"input":break;case"normal":var o=e.getSelectedNodes();o.length&&(r.clipboardData.setData("text/plain",s(o)),e.execCommand("removenode")),t.preventDefault()}}}),document.addEventListener("paste",function(t){if(document.activeElement==i.element){if("normal"!==e.getStatus())return void t.preventDefault();var o=t,s=n.state(),d=o.clipboardData.getData("text/plain");switch(s){case"input":if(!r.isPureText(d))return void t.preventDefault();break;case"normal":var c=e.getSelectedNodes();if("application/km"===r.whichMimeType(d)){var u,p=a(r.getPureText(d));c.forEach(function(t){for(var n=p.length-1;n>=0;n--)u=e.createNode(null,t),e.importNode(u,p[n]),l.push(u),t.appendChild(u)}),e.select(l,!0),l=[],e.refresh()}else{if(o.clipboardData&&o.clipboardData.items[0].type.indexOf("image")>-1){var m=o.clipboardData.items[0].getAsFile();return angular.element(document.body).injector().get("server").uploadImage(m).then(function(t){var n=t.data;0===n.errno&&e.execCommand("image",n.data.url)})}c.forEach(function(t){e.Text2Children(t,d)})}t.preventDefault()}}})}function s(n){for(var i=[],r=0,a=n.length;r<a;r++)i.push(e.exportNode(n[r]));return o(t.getRegisterProtocol("json").encode(i))}}}},e[7]={value:function(e,t,n){return n.exports=function(){var e;if(!(e="string"==typeof this.selector?document.querySelector(this.selector):this.selector))throw new Error("Invalid selector: "+this.selector);e.classList.add("km-editor"),this.container=e}}},e[8]={value:function(t,n,i){var r=e.r(2);new(e.r(19))("drag");return i.exports=function(){var e,t,n=this.fsm,i=this.minder,o=this.hotbox;this.receiver.element,n.when("* -> drag",function(){}),n.when("drag -> *",function(e,t,n){});var a,l,s,d,c,u,p=1,m=!1,g=!1;function f(e,t){if(!e)return m=g=!1,u&&kity.releaseFrame(u),void(u=null);u||(u=kity.requestFrame(function(e,t,n){return function(i){switch(e){case"left":n._viewDragger.move({x:-t,y:0},0);break;case"top":n._viewDragger.move({x:0,y:-t},0);break;case"right":n._viewDragger.move({x:t,y:0},0);break;case"bottom":n._viewDragger.move({x:0,y:t},0);break;default:return}i.next()}}(e,t,i)))}i.on("mousedown",function(n){p=0;var r=i.getPaper().container.getBoundingClientRect();e=n.originEvent.clientX,t=n.originEvent.clientY,c=r.top,a=r.width,l=r.height}),i.on("mousemove",function(u){if("drag"===n.state()&&0==p&&i.getSelectedNode()&&(Math.abs(e-u.originEvent.clientX)>20||Math.abs(t-u.originEvent.clientY)>20)&&(s=u.originEvent.clientX,d=u.originEvent.clientY-c,s<20?f("right",20-s):s>a-20?f("left",20+s-a):m=!0,d<20?f("bottom",d):d>l-20?f("top",20+d-l):g=!0,m&&g&&f(!1)),"drag"!==n.state()&&0===p&&i.getSelectedNode()&&(Math.abs(e-u.originEvent.clientX)>20||Math.abs(t-u.originEvent.clientY)>20))return"hotbox"===n.state()&&o.active(r.STATE_IDLE),n.jump("drag","user-drag")}),window.addEventListener("mouseup",function(){if(p=1,"drag"===n.state())return f(!1),n.jump("normal","drag-finish")},!1)}}},e[9]={value:function(t,n,i){var r=new(e.r(19))("fsm");function o(e,t,n,i){return e.when==t&&(("*"==e.enter||e.enter==i)&&("*"==e.exit||e.exit==n||void 0))}function a(e){var t=e,n=[];this.jump=function(e,i){if(!i)throw new Error("Please tell fsm the reason to jump");var a,l,s=t,d=[s,e].concat([].slice.call(arguments,1));for(a=0;a<n.length;a++)if(o((l=n[a]).condition,"before",s,e)&&l.apply(null,d))return;for(t=e,r.log("[{0}] {1} -> {2}",i,s,e),a=0;a<n.length;a++)o((l=n[a]).condition,"after",s,e)&&l.apply(null,d);return t},this.state=function(){return t},this.when=function(e,t){var i,r,o,a;if(1==arguments.length&&(t=e,e="* -> *"),2==(r=e.split(" - ")).length?i="before":2==(r=e.split(" -> ")).length&&(i="after"),!i)throw new Error("Illegal fsm condition: "+e);o=r[0],a=r[1],t.condition={when:i,exit:o,enter:a},n.push(t)}}return i.exports=function(){this.fsm=new a("normal")}}},e[10]={value:function(t,n,i){var r=e.r(22);return window.diff=r,i.exports=function(){var e,t,n,i,o=this.minder,a=this.hotbox,l=this.lang.t,s=100;function d(){n=[],i=[],e=o.exportJson()}function c(){var t=o.exportJson(),i=r(t,e);if(i.length){for(n.push(i);n.length>s;)n.shift();return e=t,!0}}function u(){t=!0;var a,l=n.pop();l&&(o.applyPatches(l),a=o.exportJson(),i.push(r(a,e)),e=a),t=!1}function p(){t=!0;var e=i.pop();e&&(o.applyPatches(e),c()),t=!1}function m(){return!!n.length}function g(){return!!i.length}this.history={reset:d,undo:u,redo:p,hasUndo:m,hasRedo:g},d(),o.on("contentchange",function(){t||c()&&(i=[])}),o.on("import",d),o.on("patch",function(e){if(t){var n=e.patch;switch(n.express){case"node.add":o.select(n.node.getChild(n.index),!0);break;case"node.remove":case"data.replace":case"data.remove":case"data.add":o.select(n.node,!0)}}});var f=a.state("main");f.button({position:"top",label:l("undo","runtime/history"),key:"Ctrl + Z",enable:m,action:u,next:"idle"}),f.button({position:"top",label:l("redo","runtime/history"),key:"Ctrl + Y",enable:g,action:p,next:"idle"})}}},e[11]={value:function(t,n,i){var r=e.r(2);return i.exports=function(){var e=this.fsm,t=this.minder,n=this.receiver,i=this.container,o=new r(i);o.setParentFSM(e),e.when("normal -> hotbox",function(e,n,i){var r,a=t.getSelectedNode();if(a){var l=a.getRenderBox();r={x:l.cx,y:l.cy}}o.active("main",r)}),e.when("normal -> normal",function(e,n,i,r){"shortcut-handle"==i&&(o.dispatch(r)?r.preventDefault():t.dispatchKeyEvent(r))}),e.when("modal -> normal",function(e,t,i,r){"import-text-finish"==i&&n.element.focus()}),this.hotbox=o}}},e[12]={value:function(t,n,i){e.r(21);var r=new(e.r(19))("input");return i.exports=function(){var e=this.fsm,t=this.minder,n=this.hotbox,i=this.receiver,o=i.element,a=window.kity.Browser.gecko,l=this.lang.t;function s(){var n=t.getSelectedNode();if(n){var r=o;if(o.innerText="","bold"===n.getData("font-weight")){var l=document.createElement("b");r.appendChild(l),r=l}if("italic"===n.getData("font-style")){var s=document.createElement("i");r.appendChild(s),r=s}r.innerText=t.queryCommandValue("text"),a&&i.fixFFCaretDisappeared(),e.jump("input","input-request"),i.selectAll()}}function d(){var e=t.getSelectedNode();if(e){var n=e.getData("font-size")||e.getStyle("font-size");o.style.fontSize=n+"px",o.style.minWidth=0,o.style.minWidth=o.clientWidth+"px",o.style.fontWeight=e.getData("font-weight")||"",o.style.fontStyle=e.getData("font-style")||"",o.classList.add("input"),o.focus()}}function c(){o.classList.remove("input"),i.selectAll()}function u(){var e=u,n=t.getSelectedNode();n&&(e.timer||(e.timer=setTimeout(function(){var t=n.getRenderBox("TextRenderer");o.style.left=Math.round(t.x)+"px",o.style.top=(r.flaged?Math.round(t.bottom+30):Math.round(t.y))+"px",e.timer=0})))}r.flaged&&o.classList.add("debug"),o.onmousedown=function(e){e.stopPropagation()},t.on("layoutallfinish viewchange viewchanged selectionchange",function(t){"viewchange"==t.type&&"input"!=e.state()||u()}),u(),e.when("* -> input",d),e.when("input -> *",function(e,n,i){switch(i){case"input-cancel":return c();case"input-commit":default:return function(){var e=[].slice.call(o.childNodes);setTimeout(function(){o.innerHTML=""},0);var n=t.getSelectedNode();if(e=function(e){for(var n,i,r,o="",a=/\S/,l=new RegExp("( |"+String.fromCharCode(160)+")"),s=document.createElement("br"),d=!1,u=!1,p=0,m=e.length;p<m;p++)switch(n=e[p],Object.prototype.toString.call(n)){case"[object HTMLBRElement]":o+="\n";break;case"[object Text]":if(n=n.textContent.replace("&nbsp;"," "),a.test(n))o+=n;else for(r=n.length;r--;)l.test(n[r])?o+=" ":"\t"===n[r]&&(o+="\t");break;case"[object HTMLElement]":switch(n.nodeName){case"B":d=!0;break;case"I":u=!0}[].splice.apply(e,[p,1].concat([].slice.call(n.childNodes))),m=e.length,p--;break;case"[object HTMLSpanElement]":[].splice.apply(e,[p,1].concat([].slice.call(n.childNodes))),m=e.length,p--;break;case"[object HTMLImageElement]":n.src&&/http(|s):\/\//.test(n.src)&&t.execCommand("Image",n.src,n.alt);break;case"[object HTMLDivElement]":i=[];for(var g=0,m=n.childNodes.length;g<m;g++)i.push(n.childNodes[g]);i.push(s),[].splice.apply(e,[p,1].concat(i)),m=e.length,p--;break;default:if(n&&n.childNodes.length){i=[];for(var g=0,m=n.childNodes.length;g<m;g++)i.push(n.childNodes[g]);i.push(s),[].splice.apply(e,[p,1].concat(i)),m=e.length,p--}else n&&void 0!==n.textContent?o+=n.textContent:o+=""}return o=(o=o.replace(/^\n*|\n*$/g,"")).replace(new RegExp("(\n|\r|\n\r)( |"+String.fromCharCode(160)+"){4}","g"),"$1\t"),t.getSelectedNode().setText(o),d?t.queryCommandState("bold")||t.execCommand("bold"):t.queryCommandState("bold")&&t.execCommand("bold"),u?t.queryCommandState("italic")||t.execCommand("italic"):t.queryCommandState("italic")&&t.execCommand("italic"),c(),o}(e),function(e,n){try{t.decodeData("text",n).then(function(n){!function e(t,n,i){var r=n.data;t.setText(r.text||"");for(var o=n.children||[],a=0;a<o.length;a++){var l=i.createNode(null,t);e(l,o[a],i)}return t}(e,n,t),t.fire("contentchange"),t.getRoot().renderTree(),t.layout(300)})}catch(e){if(t.fire("contentchange"),t.getRoot().renderTree(),"Error: Invalid local format"!==e.toString())throw e}}(n,e),"root"==n.type){var i=t.getRoot().getText();t.fire("initChangeRoot",{text:i})}}()}}),i.onblur(function(t){"input"==e.state()&&e.jump("normal","input-commit")}),t.on("beforemousedown",function(){"input"==e.state()&&e.jump("normal","input-commit")}),t.on("dblclick",function(){t.getSelectedNode()&&"readonly"!==t._status&&s()}),n.state("main").button({position:"center",label:l("edit","runtime/input"),key:"F2",enable:function(){return-1!=t.queryCommandState("text")},action:s}),this.editText=s}}},e[13]={value:function(t,n,i){var r=e.r(2);return i.exports=function(){var e,t,n=this.fsm,i=this.minder,o=this.receiver,a=this.container,l=o.element,s=this.hotbox;o.listen("normal",function(e){if(o.enable(),e.is("Space"))return e.preventDefault(),kity.Browser.safari&&(l.innerHTML=""),n.jump("hotbox","space-trigger");switch(e.type){case"keydown":if(i.getSelectedNode()){if(function(e){return!(e.ctrlKey||e.metaKey||e.altKey)&&(e.keyCode>=65&&e.keyCode<=90||e.keyCode>=48&&e.keyCode<=57||108!=e.keyCode&&e.keyCode>=96&&e.keyCode<=111||108!=e.keyCode&&e.keyCode>=96&&e.keyCode<=111||229==e.keyCode||0===e.keyCode)}(e))return n.jump("input","user-input")}else l.innerHTML="";n.jump("normal","shortcut-handle",e)}}),o.listen("hotbox",function(e){if(o.disable(),e.preventDefault(),s.dispatch(e),s.state()==r.STATE_IDLE&&"hotbox"==n.state())return n.jump("normal","hotbox-idle")}),o.listen("input",function(e){if(o.enable(),"keydown"==e.type){if(e.is("Enter"))return e.preventDefault(),n.jump("normal","input-commit");if(e.is("Esc"))return e.preventDefault(),n.jump("normal","input-cancel");(e.is("Tab")||e.is("Shift + Tab"))&&e.preventDefault()}else if("keyup"==e.type&&e.is("Esc"))return e.preventDefault(),n.jump("normal","input-cancel")}),a.addEventListener("mousedown",function(i){2==i.button&&i.preventDefault(),"hotbox"==n.state()?(s.active(r.STATE_IDLE),n.jump("normal","blur")):"normal"==n.state()&&2==i.button&&(e=i.clientX,t=i.clientY)},!1),a.addEventListener("mousewheel",function(e){"hotbox"==n.state()&&(s.active(r.STATE_IDLE),n.jump("normal","mousemove-blur"))},!1),a.addEventListener("contextmenu",function(e){e.preventDefault()}),a.addEventListener("mouseup",function(r){"normal"==n.state()&&2==r.button&&r.clientX==e&&r.clientY==t&&i.getSelectedNode()&&n.jump("hotbox","content-menu")},!1),s.$element.addEventListener("mousedown",function(e){e.stopPropagation()})}}},e[14]={value:function(t,n,i){var r=e.r(4);return i.exports=function(){var e=this.lang.t,t=new r({enableKeyReceiver:!1,enableAnimation:!0});t.renderTo(this.selector),t.setTheme(null),t.select(t.getRoot(),!0),t.execCommand("text",e("maintopic","runtime/minder")),this.minder=t}}},e[15]={value:function(e,t,n){return n.exports=function(){var e=this,t=this.minder,n=this.hotbox,i=this.fsm,r=this.lang.t,o=n.state("main"),a=[r("arrangeup","runtime/node")+":Alt+Up:ArrangeUp",r("appendchildnode","runtime/node")+":Tab|Insert:AppendChildNode",r("appendsiblingnode","runtime/node")+":Enter:AppendSiblingNode",r("arrangedown","runtime/node")+":Alt+Down:ArrangeDown",r("removenode","runtime/node")+":Delete|Backspace:RemoveNode",r("appendparentnode","runtime/node")+":Shift+Tab|Shift+Insert:AppendParentNode"],l=0;a.forEach(function(n){var a=n.split(":"),s=a.shift(),d=a.shift(),c=a.shift();o.button({position:"ring",label:s,key:d,action:function(){0===c.indexOf("Append")?(l++,t.execCommand(c,r("topic","runtime/node")),t.on("layoutallfinish",function n(){--l||e.editText(),t.off("layoutallfinish",n)})):(t.execCommand(c),i.jump("normal","command-executed"))},enable:function(){return-1!=t.queryCommandState(c)}})}),o.button({position:"bottom",label:r("importnode","runtime/node"),key:"Alt + V",enable:function(){return 1==t.getSelectedNodes().length},action:function(){t.fire("importNodeData")},next:"idle"}),o.button({position:"bottom",label:r("exportnode","runtime/node"),key:"Alt + C",enable:function(){return 1==t.getSelectedNodes().length},action:function(){t.fire("exportNodeData")},next:"idle"})}}},e[16]={value:function(e,t,n){return n.exports=function(){var e=this.minder,t=this.hotbox,n=this.lang.t;t.state("main").button({position:"top",label:n("main","runtime/priority"),key:"P",next:"priority",enable:function(){return-1!=e.queryCommandState("priority")}});var i=t.state("priority");"123456789".replace(/./g,function(t){i.button({position:"ring",label:"P"+t,key:t,action:function(){e.execCommand("Priority",t)}})}),i.button({position:"center",label:n("remove","runtime/priority"),key:"Del",action:function(){e.execCommand("Priority",0)}}),i.button({position:"top",label:n("esc","runtime/priority"),key:"esc",next:"back"})}}},e[17]={value:function(e,t,n){return n.exports=function(){var e=this.minder,t=this.hotbox,n=this.lang.t;t.state("main").button({position:"top",label:n("main","runtime/progress"),key:"G",next:"progress",enable:function(){return-1!=e.queryCommandState("progress")}});var i=t.state("progress");"012345678".replace(/./g,function(t){i.button({position:"ring",label:"G"+t,key:t,action:function(){e.execCommand("Progress",parseInt(t)+1)}})}),i.button({position:"center",label:n("remove","runtime/progress"),key:"Del",action:function(){e.execCommand("Progress",0)}}),i.button({position:"top",label:n("esc","runtime/progress"),key:"esc",next:"back"})}}},e[18]={value:function(t,n,i){var r=e.r(23);e.r(2);return i.exports=function(){var e=this.fsm,t=this.minder,n=document.createElement("div");n.contentEditable=!0,n.setAttribute("tabindex",-1),n.classList.add("receiver"),n.onkeydown=n.onkeypress=n.onkeyup=function(t){var n;t.is=function(e){for(var t=e.split("|"),n=0;n<t.length;n++)if(r.is(this,t[n]))return!0;return!1};for(var i=0;i<o.length;i++)if(("*"==(n=o[i]).notifyState||n.notifyState==e.state())&&n.call(null,t))return},this.container.appendChild(n);var i={element:n,selectAll:function(){n.innerHTML||(n.innerHTML="&nbsp;");var e=document.createRange(),t=window.getSelection();e.selectNodeContents(n),t.removeAllRanges(),t.addRange(e),n.focus()},enable:function(){n.setAttribute("contenteditable",!0)},disable:function(){n.setAttribute("contenteditable",!1)},fixFFCaretDisappeared:function(){n.removeAttribute("contenteditable"),n.setAttribute("contenteditable","true"),n.blur(),n.focus()},onblur:function(e){n.onblur=e}};i.selectAll(),t.on("beforemousedown",i.selectAll),t.on("receiverfocus",i.selectAll),t.on("readonly",function(){t.disable(),editor.receiver.element.parentElement.removeChild(editor.receiver.element),editor.hotbox.$container.removeChild(editor.hotbox.$element)});var o=[];i.listen=function(e,t){1==arguments.length&&(t=e,e="*"),t.notifyState=e,o.push(t)},this.receiver=i}}},e[19]={value:function(t,n,i){var r=e.r(20);function o(){}return i.exports=function(e){if(this.flaged=-1!=window.location.search.indexOf(e)){var t=function(e){for(var t=0,n=0;n<e.length;n++)t+=e.charCodeAt(n);return t}(e)%360,n=r("background: hsl({0}, 50%, 80%); color: hsl({0}, 100%, 30%); padding: 2px 3px; margin: 1px 3px 0 0;border-radius: 2px;",t);this.log=function(){var t=r.apply(null,arguments);console.log(r("%c{0}%c{1}",e,t),n,"background: none; color: black;")}}else this.log=o}}},e[20]={value:function(e,t,n){return n.exports=function(e,t){return"object"!=typeof t&&(t=[].slice.call(arguments,1)),String(e).replace(/\{(\w+)\}/gi,function(e,n){return t[n]||n})}}},e[21]={value:function(e,t,n){!("innerText"in document.createElement("a"))&&"getSelection"in window&&(HTMLElement.prototype.__defineGetter__("innerText",function(){var e,t,n=window.getSelection(),i=[];for(t=0;t<n.rangeCount;t++)i[t]=n.getRangeAt(t);for(n.removeAllRanges(),n.selectAllChildren(this),e=n.toString(),n.removeAllRanges(),t=0;t<i.length;t++)n.addRange(i[t]);return e}),HTMLElement.prototype.__defineSetter__("innerText",function(e){this.innerHTML=(e||"").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\n/g,"<br>")}))}},e[22]={value:function(e,t,n){var i=Object.keys?Object.keys:function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t};function r(e){return-1===e.indexOf("/")&&-1===e.indexOf("~")?e:e.replace(/~/g,"~0").replace(/\//g,"~1")}function o(e){return"object"==typeof e?JSON.parse(JSON.stringify(e)):e}return n.exports=function(e,t){var n=[];return function e(t,n,a,l){for(var s=i(n),d=i(t),c=!1,u=d.length-1;u>=0;u--){var p=t[g=d[u]];if(n.hasOwnProperty(g)){var m=n[g];"object"==typeof p&&null!=p&&"object"==typeof m&&null!=m?e(p,m,a,l+"/"+r(g)):p!=m&&a.push({op:"replace",path:l+"/"+r(g),value:o(m)})}else a.push({op:"remove",path:l+"/"+r(g)}),c=!0}if(c||s.length!=d.length)for(u=0;u<s.length;u++){var g=s[u];t.hasOwnProperty(g)||a.push({op:"add",path:l+"/"+r(g),value:o(n[g])})}}(e,t,n,""),n}}},e[23]={value:function(t,n,i){var r=e.r(24),o=4096,a=8192,l=16384;function s(e){return"string"==typeof e?(t=0,e.toLowerCase().split(/\s*\+\s*/).forEach(function(e){switch(e){case"ctrl":case"cmd":t|=o;break;case"alt":t|=a;break;case"shift":t|=l;break;default:t|=r[e]}}),t):function(e){var t=0;(e.ctrlKey||e.metaKey)&&(t|=o);e.altKey&&(t|=a);e.shiftKey&&(t|=l);if(-1===[16,17,18,91].indexOf(e.keyCode)){if(229===e.keyCode&&e.keyIdentifier)return t|=parseInt(e.keyIdentifier.substr(2),16);t|=e.keyCode}return t}(e);var t}n.hash=s,n.is=function(e,t){return e&&t&&s(e)==s(t)}}},e[24]={value:function(e,t,n){var i={Shift:16,Control:17,Alt:18,CapsLock:20,BackSpace:8,Tab:9,Enter:13,Esc:27,Space:32,PageUp:33,PageDown:34,End:35,Home:36,Insert:45,Left:37,Up:38,Right:39,Down:40,Direction:{37:1,38:1,39:1,40:1},Del:46,NumLock:144,Cmd:91,CmdFF:224,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,"`":192,"=":187,"-":189,"/":191,".":190};for(var r in i)i.hasOwnProperty(r)&&(i[r.toLowerCase()]=i[r]);var o="a".charCodeAt(0);"abcdefghijklmnopqrstuvwxyz".split("").forEach(function(e){i[e]=e.charCodeAt(0)-o+65});var a=9;do{i[a.toString()]=a+48}while(--a);n.exports=i}},e[25]={value:function(e,t,n){return n.exports={template:{default:"Mind Map",tianpan:"Spiralform",structure:"Organigramm",filetree:"Verzeichnis-Organigramm",right:"Logisches Strukturdiagramm","fish-bone":"Fischknochenfigur"},theme:{classic:"Klassisch","classic-compact":"Klassisch Kompakt",snow:"Klassisch 2","snow-compact":"Kompakt klassisch 2",fish:"Fischknochen",wire:"Drahtgitter","fresh-red":"Rot","fresh-soil":"Braun","fresh-green":"Grün","fresh-blue":"Blau","fresh-purple":"Lila","fresh-pink":"Pink","fresh-red-compat":"Kompakt rot","fresh-soil-compat":"Kompakt braun","fresh-green-compat":"Kompakt grün","fresh-blue-compat":"Kompakt blau","fresh-purple-compat":"Kompakt lila","fresh-pink-compat":"Kompakt pink",tianpan:"Runde Knoten","tianpan-compact":"Kompakt runde Knoten"},maintopic:"Hauptthema",topic:"Zweigthema",panels:{history:"Verlauf",template:"Vorlage",theme:"Darstellung",layout:"Layout",style:"Stil",font:"Schriftgröße",color:"Schriftfarbe",background:"Hintergrundfarbe",insert:"Einfügen",arrange:"Anordnen",nodeop:"aktuell",priority:"Priorität",progress:"Fortschritt",resource:"Ressourcen",note:"Notizen",attachment:"Anhang",word:"Text"},ui:{command:{appendsiblingnode:"Neuer Geschwisterknoten",appendparentnode:"Neuer Überknoten unterhalb",appendchildnode:"Neuer Unterknoten",removenode:"Löschen",editnode:"Bearbeiten",arrangeup:"nach oben",arrangedown:"nach unten",resetlayout:"Layout zurücksetzen",expandtoleaf:"Alle Knoten ausklappen",expandtolevel1:"Ausklappen bis Knoten der 1. Ebene",expandtolevel2:"Ausklappen bis zu Knoten der 2. Ebene",expandtolevel3:"Ausklappen bis zu Knoten der 3. Ebene",expandtolevel4:"Ausklappen bis zu Knoten der 4. Ebene",expandtolevel5:"Ausklappen bis zu Knoten der 5. Ebene",expandtolevel6:"Ausklappen bis zu Knoten der 6. Ebene",fullscreen:"Vollbild",outline:"Gliederung"},search:"Suchen",expandtoleaf:"Erweitern",back:"Zurück",undo:"Rückgängig",redo:"Wiederholen",tabs:{idea:"Idee",appearence:"Darstellung",view:"Ansicht"},bold:"Fett",italic:"Kursiv",forecolor:"Schriftfarbe",fontfamily:"Schriftart",fontsize:"Schriftgröße",layoutstyle:"Darstellung",node:"Knotenoperation",hand:"Verschieben",camera:"Stammknoten zentrieren","zoom-in":"Vergrößern","zoom-out":"Verkleinern",markers:"Markierungen",help:"Hilfe",preference:"Einstellungen",expandnode:"Auf das Blatt erweitern",collapsenode:"einen Level-1-Knoten erhalten",template:"Vorlage",theme:"Darstellung",clearstyle:"Formatierung löschen",copystyle:"Formatierung kopieren",pastestyle:"Formatierung übertragen",appendsiblingnode:"Geschwisterknoten einfügen",appendchildnode:"Kindknoten einfügen",arrangeup:"Voreinstellung",arrangedown:"Nachstimmen",editnode:"Bearbeiten",removenode:"Löschen",priority:"Priorität",progress:{p1:"Nicht begonnen",p2:"1/8 fertiggestellt",p3:"1/4 fertiggestellt",p4:"3/8 fertiggestellt",p5:"1/2 fertiggestellt",p6:"5/8 fertiggestellt",p7:"3/4 fertiggestellt",p8:"7/8 fertiggestellt",p9:"Abgeschlossen",p0:"Klarer Fortschritt"},resource:{add:"hinzufügen"},link:"Link",image:"Bild",note:"Notiz",insertlink:"Link einfügen",insertimage:"Bild einfügen",insertnote:"Notiz einfügen",removelink:"Link löschen",removeimage:"Bild löschen",removenote:"Notiz löschen",resetlayout:"Organisieren",navigator:"Navigator",selectall:"Alles auswählen",selectrevert:"Auswahl umkehren",selectsiblings:"Geschwisterknoten auswählen",selectlevel:"Alle Knoten derselben Ebene auswählen",selectpath:"Pfad auswählen",selecttree:"Teilbaum auswählen",noteeditor:{title:"Notiz",hint:"Formatierungshilfe (chinesisch)",placeholder:"Notiz zum Bearbeiten auswählen"},dialog:{image:{title:"Bild",imagesearch:"Bild suchen",keyword:"Schlagwort：",placeholder:"Bitte Schlagwort für Suche eingeben",baidu:"Suchen",linkimage:"Link auf Bild",linkurl:"URL：",placeholder2:"Muss mit http(s):// beginnen",imagehint:"Hinweis：",placeholder3:"Optional：Text für den Tooltip, wenn die Maus sich über dem Bild befindet",preview:"Bildvorschau：",uploadimage:"Bild hochladen",selectfile:"Datei auswählen",ok:"OK",cancel:"Abbrechen",formatinfo:"Bild im Format jpg, gif oder png"},hyperlink:{title:"Link",linkurl:"URL：",linkhint:"Hinweis：",placeholder:"Muss mit http(s):// oderftp:// beginnen",placeholder2:"Optional: Text für den Tooltip, wenn die Maus sich über dem Link befindet",ok:"OK",cancel:"Abbrechen"},exportnode:{title:"Knoten exportieren",ok:"OK",cancel:"Abbrechen"}}},runtime:{minder:{maintopic:"Hauptthema"},node:{arrangeup:"Arrange Up",appendchildnode:"Neuer Unterknoten",appendsiblingnode:"Neuer Geschwisterknoten",arrangedown:"Arrange Down",removenode:"Knoten löschen",appendparentnode:"Append Parent Node",selectall:"Alles auswählen",topic:"Thema",importnode:"Knoten importieren",exportnode:"Knoten exportieren"},input:{edit:"Bearbeiten"},priority:{main:"Priorität",remove:"Löschen",esc:"Abbrechen"},progress:{main:"Fortschritt",remove:"Löschen",esc:"Abbrechen"},history:{undo:"Rückgängig",redo:"Wiederholen"}}}}},e[26]={value:function(e,t,n){return n.exports={template:{default:"Mind map",tianpan:"Sky map",structure:"Organization Chart",filetree:"Directory organization chart",right:"logical structure diagram","fish-bone":"Fish bone figure"},theme:{classic:"Classic","classic-compact":"Compact classic",snow:"Gentle cold light","snow-compact":"Compact cold light",fish:"Fish bone map",wire:"Wireframe","fresh-red":"Fresh red","fresh-soil":"Dirty yellow","fresh-green":"Artistic Green","fresh-blue":"Sky Blue","fresh-purple":"Romantic Purple","fresh-pink":"Mind powder","fresh-red-compat":"Compact red","fresh-soil-compat":"Compact yellow","fresh-green-compat":"Compact green","fresh-blue-compat":"Compact blue","fresh-purple-compat":"Compact purple","fresh-pink-compat":"Compact powder",tianpan:"Classic dial","tianpan-compact":"Compact day"},maintopic:"Center theme",topic:"branch topic",panels:{history:"history",template:"template",theme:"skin",layout:"layout",style:"style",font:"text",color:"color",background:"background",insert:"insert",arrange:"adjust",nodeop:"current",priority:"priority",progress:"progress",resource:"resource",note:"note",attachment:"attachment",word:"text"},ui:{command:{appendsiblingnode:"Insert sibling node",appendparentnode:"Insert parent node",appendchildnode:"Insert child node",removenode:"Delete",editnode:"Edit",arrangeup:"Up",arrangedown:"Down",resetlayout:"Reset layout",expandtoleaf:"Expand all nodes",expandtolevel1:"Expand to level 1",expandtolevel2:"Expand to level 2",expandtolevel3:"Expand to level 3",expandtolevel4:"Expand to level 4",expandtolevel5:"Expand to level 5",expandtolevel6:"Expand to level 6",fullscreen:"full screen",outline:"outline"},search:"Search",expandtoleaf:"Expand",back:"return",undo:"Undo (Ctrl + Z)",redo:"Redo (Ctrl + Y)",tabs:{idea:"Idea",appearence:"Appearance",view:"View"},bold:"Bold",italic:"Italic",forecolor:"Font color",fontfamily:"Font",fontsize:"Size",layoutstyle:"Theme",node:"Node operation",hand:"Allow dragging",camera:"Locate the root node","zoom-in":"Zoom in (Ctrl+)","zoom-out":"Zoom out (Ctrl-)",markers:"tag",help:"Help",preference:"Preferences",expandnode:"Expand to leaf",collapsenode:"receive a level one node",template:"template",theme:"skin",clearstyle:"Clear style",copystyle:"Copy style",pastestyle:"Paste style",appendsiblingnode:"same theme",appendchildnode:"subordinate theme",arrangeup:"pre-tune",arrangedown:"post-tune",editnode:"Edit",removenode:"remove",priority:"Priority",progress:{p1:"not started",p2:"Complete 1/8",p3:"Complete 1/4",p4:"Complete 3/8",p5:"Complete half",p6:"Complete 5/8",p7:"Complete 3/4",p8:"Complete 7/8",p9:"Completed",p0:"Clear progress"},resource:{add:"Add"},link:"Link",image:"Image",note:"Note",insertlink:"Insert link",insertimage:"Insert image",insertnote:"Insert note",removelink:"Remove existing links",removeimage:"Remove existing image",removenote:"Remove existing notes",resetlayout:"Organize",navigator:"Navigator",selectall:"Select all",selectrevert:"Select revert",selectsiblings:"Select siblings",selectlevel:"Select level",selectpath:"Select path",selecttree:"Select subtree",noteeditor:{title:"Note",hint:"Support GFM grammar",placeholder:"Please select a node to edit note"},dialog:{image:{title:"Image",imagesearch:"Image search",keyword:"Keyword：",placeholder:"Please input the keyword for search",baidu:"Search",linkimage:"Linked Image",linkurl:"URL：",placeholder2:"Require：start with http(s)://",imagehint:"Hint：",placeholder3:"Optional：The text that the mouse prompts when hovering over the image",preview:"Image preview：",uploadimage:"Upload Image",selectfile:"Select file...",ok:"OK",cancel:"Cancel",formatinfo:"file ext must be jpg、gif or png"},hyperlink:{title:"Link",linkurl:"Link url：",linkhint:"Hint：",placeholder:"Require：start with http(s):// or ftp://",placeholder2:"Optional: The text that the mouse prompts when hovering over the link",ok:"OK",cancel:"Cancel"},exportnode:{title:"Export Node",ok:"OK",cancel:"Cancel"}}},runtime:{minder:{maintopic:"Main Topic"},node:{arrangeup:"Arrange Up",appendchildnode:"Append Child Node",appendsiblingnode:"Append Sibling Node",arrangedown:"Arrange Down",removenode:"Delete",appendparentnode:"Append Parent Node",selectall:"Select All",topic:"Topic",importnode:"Import Node",exportnode:"Export Node"},input:{edit:"Edit"},priority:{main:"Priority",remove:"Delete",esc:"Esc"},progress:{main:"Progress",remove:"Delete",esc:"Esc"},history:{undo:"Undo",redo:"Redo"}}}}},e[27]={value:function(e,t,n){return n.exports={template:{default:"Mindmap",tianpan:"Nébuleuse",structure:"Organigramme",filetree:"Organigramme annuaire",right:"Diagramme logique","fish-bone":"Squelette"},theme:{classic:"Classique","classic-compact":"Classique compact",snow:"Sombre","snow-compact":"Sombre compact",fish:"Squelette",wire:"Fil de fer","fresh-red":"Rouge","fresh-soil":"Marron","fresh-green":"Vert","fresh-blue":"Bleu","fresh-purple":"Violet","fresh-pink":"Rose","fresh-red-compat":"Rouge compact","fresh-soil-compat":"Marron compact","fresh-green-compat":"Vert compact","fresh-blue-compat":"Bleu compact","fresh-purple-compat":"Violet compact","fresh-pink-compat":"Rose compact",tianpan:"Cadran","tianpan-compact":"Cadran compact"},maintopic:"Sujet principal",topic:"branche",panels:{history:"historique",template:"modele",theme:"theme",layout:"disposition",style:"style",font:"texte",color:"couleur",background:"",insert:"insérer",arrange:"ajuster",nodeop:"actuel",priority:"priorité",progress:"progression",resource:"ressource",note:"note",attachment:"fichier joint",word:"texte"},ui:{command:{appendsiblingnode:"Insérer noeud voisin",appendparentnode:"Insérer noeud parent",appendchildnode:"Insérer noeud enfant",removenode:"Supprimer",editnode:"Editer",arrangeup:"Monter",arrangedown:"Descendre",resetlayout:"Re-organise",expandtoleaf:"Déplier tous les noeuds",expandtolevel1:"Déplier au niveau 1",expandtolevel2:"Déplier au niveau 2",expandtolevel3:"Déplier au niveau 3",expandtolevel4:"Déplier au niveau 4",expandtolevel5:"Déplier au niveau 5",expandtolevel6:"Déplier au niveau 6",fullscreen:"Plein écran",outline:"contour"},search:"Recherche",expandtoleaf:"Déplier",back:"retour",undo:"Annuler (Ctrl + Z)",redo:"Rétablir (Ctrl + Y)",tabs:{idea:"Edition",appearence:"Style",view:"Affichage"},bold:"Gras",italic:"Italic",forecolor:"Couleur",fontfamily:"Police",fontsize:"Taille",layoutstyle:"Theme",node:"Node operation",hand:"Activer le glisser",camera:"Centrer sur le noeud principal","zoom-in":"Agrandir (Ctrl+)","zoom-out":"Dezoomer (Ctrl-)",markers:"tag",help:"Aide",preference:"Préférences",expandnode:"Déplier le noeud",collapsenode:"Fermer le noeud",template:"modèle",theme:"style",clearstyle:"Effacer le style",copystyle:"Copier le style",pastestyle:"Coller le style",appendsiblingnode:"Même theme",appendchildnode:"theme enfant",arrangeup:"Monter",arrangedown:"Descendre",editnode:"Editer",removenode:"Supprimer","no priority":"Pas de priorité",priority:"Priorité",progress:{p1:"Non démarré",p2:"Completé à 1/8",p3:"Completé à 1/4",p4:"Completé à 3/8",p5:"Completé à moité",p6:"Completé à 5/8",p7:"Completé à 3/4",p8:"Completé à 7/8",p9:"Terminé",p0:"Supprimer la progression"},resource:{add:"Ajouter"},link:"Lien",image:"Image",note:"Note",insertlink:"Inserer un lien",insertimage:"Inserer une image",insertnote:"Inserer une note",removelink:"Supprimer un lien existant",removeimage:"Supprimer une image existante",removenote:"Supprimer une note existante",resetlayout:"Re-organise",navigator:"Navigateur",selectall:"Selectionner tout",selectrevert:"Inverser la selection",selectsiblings:"Sélectionner les voisins",selectlevel:"Sélectionner le niveau",selectpath:"Sélectionner le chemin",selecttree:"Sélectionner la sous-arborescence",noteeditor:{title:"Note",hint:"Supporte la syntax GFM",placeholder:"Merci de sélectionner une note"},dialog:{image:{title:"Image",imagesearch:"Recherche d'image",keyword:"Mot clé：",placeholder:"Mot(s) clé(s) de recherche",baidu:"Recherche",linkimage:"Lien vers l'image",linkurl:"Adresse：",placeholder2:"Requis：Commence par http(s)://",imagehint:"Astuce：",placeholder3:"Optionnel：Texte au survol de l'image",preview:"Apercus de l'image：",uploadimage:"Charger une image",selectfile:"Ouvrir un fichier...",ok:"OK",cancel:"Annuler",formatinfo:"Le fichier doit être jpg, gif ou png"},hyperlink:{title:"Lien",linkurl:"Adresse：",linkhint:"Astuce：",placeholder:"Requis：Commence par http(s):// ou ftp://",placeholder2:"Optionnel: Texte au survol du lien",ok:"OK",cancel:"Annuler"},exportnode:{title:"Exporter le Noeud",ok:"OK",cancel:"Annuler"},search:{result:"Résultat",on:"sur"}}},runtime:{minder:{maintopic:"Sujet Principal"},node:{arrangeup:"Monter",appendchildnode:"Enfant",appendsiblingnode:"Voisin",arrangedown:"Desc.",removenode:"Suppr.",appendparentnode:"Parent",selectall:"Tout sélectionner",topic:"Sujet",importnode:"Importer un noeud",exportnode:"Exporter un noeud"},input:{edit:"Edition"},priority:{main:"Priorité",remove:"Supprimer",esc:"Retour"},progress:{main:"Progression",remove:"Supprimer",esc:"Retour"},history:{undo:"Annuler",redo:"Rétablir"}}}}},e[28]={value:function(e,t,n){return n.exports={template:{default:"思维导图",tianpan:"天盘图",structure:"组织结构图",filetree:"目录组织图",right:"逻辑结构图","fish-bone":"鱼骨头图"},theme:{classic:"脑图经典","classic-compact":"紧凑经典",snow:"温柔冷光","snow-compact":"紧凑冷光",fish:"鱼骨图",wire:"线框","fresh-red":"清新红","fresh-soil":"泥土黄","fresh-green":"文艺绿","fresh-blue":"天空蓝","fresh-purple":"浪漫紫","fresh-pink":"脑残粉","fresh-red-compat":"紧凑红","fresh-soil-compat":"紧凑黄","fresh-green-compat":"紧凑绿","fresh-blue-compat":"紧凑蓝","fresh-purple-compat":"紧凑紫","fresh-pink-compat":"紧凑粉",tianpan:"经典天盘","tianpan-compact":"紧凑天盘"},maintopic:"中心主题",topic:"分支主题",panels:{history:"历史",template:"模板",theme:"皮肤",layout:"布局",style:"样式",font:"文字",color:"颜色",background:"背景",insert:"插入",arrange:"调整",nodeop:"当前",priority:"优先级",progress:"进度",resource:"资源",note:"备注",attachment:"附件",word:"文字"},ui:{command:{appendsiblingnode:"插入同级主题",appendparentnode:"插入上级主题",appendchildnode:"插入下级主题",removenode:"删除",editnode:"编辑",arrangeup:"上移",arrangedown:"下移",resetlayout:"整理布局",expandtoleaf:"展开全部节点",expandtolevel1:"展开到一级节点",expandtolevel2:"展开到二级节点",expandtolevel3:"展开到三级节点",expandtolevel4:"展开到四级节点",expandtolevel5:"展开到五级节点",expandtolevel6:"展开到六级节点",fullscreen:"全屏",outline:"大纲"},search:"搜索",expandtoleaf:"展开",back:"返回",undo:"撤销 (Ctrl + Z)",redo:"重做 (Ctrl + Y)",tabs:{idea:"思路",appearence:"外观",view:"视图"},bold:"加粗",italic:"斜体",forecolor:"字体颜色",fontfamily:"字体",fontsize:"字号",layoutstyle:"主题",node:"节点操作",hand:"允许拖拽",camera:"定位根节点","zoom-in":"放大（Ctrl+）","zoom-out":"缩小（Ctrl-）",markers:"标签",help:"帮助",preference:"偏好设置",expandnode:"展开到叶子",collapsenode:"收起到一级节点",template:"模板",theme:"皮肤",clearstyle:"清除样式",copystyle:"复制样式",pastestyle:"粘贴样式",appendsiblingnode:"同级主题",appendchildnode:"下级主题",arrangeup:"前调",arrangedown:"后调",editnode:"编辑",removenode:"移除",priority:"优先级",progress:{p1:"未开始",p2:"完成 1/8",p3:"完成 1/4",p4:"完成 3/8",p5:"完成一半",p6:"完成 5/8",p7:"完成 3/4",p8:"完成 7/8",p9:"已完成",p0:"清除进度"},resource:{add:"添加"},link:"链接",image:"图片",note:"备注",insertlink:"插入链接",insertimage:"插入图片",insertnote:"插入备注",removelink:"移除已有链接",removeimage:"移除已有图片",removenote:"移除已有备注",resetlayout:"整理",navigator:"导航器",selectall:"全选",selectrevert:"反选",selectsiblings:"选择兄弟节点",selectlevel:"选择同级节点",selectpath:"选择路径",selecttree:"选择子树",noteeditor:{title:"备注",hint:"支持 GFM 语法书写",placeholder:"请选择节点编辑备注"},dialog:{image:{title:"图片",imagesearch:"图片搜索",keyword:"关键词：",placeholder:"请输入搜索的关键词",baidu:"百度一下",linkimage:"外链图片",linkurl:"链接地址：",placeholder2:"必填：以 http(s):// 开头",imagehint:"提示文本：",placeholder3:"选填：鼠标在图片上悬停时提示的文本",preview:"图片预览：",uploadimage:"上传图片",selectfile:"选择文件...",ok:"确定",cancel:"取消",formatinfo:"后缀只能是 jpg、gif 及 png"},hyperlink:{title:"链接",linkurl:"链接地址：",linkhint:"提示文本：",placeholder:"必填：以 http(s):// 或 ftp:// 开头",placeholder2:"选填：鼠标在链接上悬停时提示的文本",ok:"确定",cancel:"取消"},exportnode:{title:"导出节点",ok:"确定",cancel:"取消"}}},runtime:{minder:{maintopic:"中心主题"},node:{arrangeup:"前移",appendchildnode:"下级",appendsiblingnode:"同级",arrangedown:"后移",removenode:"删除",appendparentnode:"上级",selectall:"全选",topic:"分支主题",importnode:"导入节点",exportnode:"导出节点"},input:{edit:"编辑"},priority:{main:"优先级",remove:"移除",esc:"返回"},progress:{main:"进度",remove:"移除",esc:"返回"},history:{undo:"撤销",redo:"重做"}}}}},e[29]={value:function(e,t,n){return n.exports={template:{default:"心智圖",tianpan:"天盤圖",structure:"組織圖",filetree:"樹狀圖",right:"邏輯圖","fish-bone":"魚骨圖"},theme:{classic:"經典","classic-compact":"緊湊經典",snow:"溫柔冷光","snow-compact":"緊湊冷光",fish:"魚骨圖",wire:"線框","fresh-red":"清新紅","fresh-soil":"泥土黃","fresh-green":"文藝綠","fresh-blue":"天空藍","fresh-purple":"浪漫紫","fresh-pink":"可愛粉","fresh-red-compat":"緊湊紅","fresh-soil-compat":"緊湊黃","fresh-green-compat":"緊湊綠","fresh-blue-compat":"緊湊藍","fresh-purple-compat":"緊湊紫","fresh-pink-compat":"緊湊粉",tianpan:"天盤","tianpan-compact":"緊湊天盤"},maintopic:"中心主題",topic:"分支主題",panels:{history:"歷史",template:"範本",theme:"主題",layout:"配置",style:"樣式",font:"字型",color:"顏色",background:"背景",insert:"插入",arrange:"排列",nodeop:"節點作業",priority:"優先順序",progress:"進度",resource:"資源",note:"備註",attachment:"附件",word:"文字"},ui:{command:{appendsiblingnode:"插入同層主題",appendparentnode:"插入上層主題",appendchildnode:"插入下層主題",removenode:"刪除",editnode:"編輯",arrangeup:"上移",arrangedown:"下移",resetlayout:"重新配置",expandtoleaf:"全部展開",expandtolevel1:"展開至第一級節點",expandtolevel2:"展開至第二級節點",expandtolevel3:"展開至第三級節點",expandtolevel4:"展開至第四級節點",expandtolevel5:"展開至第五級節點",expandtolevel6:"展開至第六級節點",fullscreen:"全螢幕",outline:"大綱"},search:"搜尋",expandtoleaf:"展開",back:"返回",undo:"復原 (Ctrl + Z)",redo:"取消復原 (Ctrl + Y)",tabs:{idea:"思考",appearence:"外觀",view:"檢視"},bold:"粗體",italic:"斜體",forecolor:"顏色",fontfamily:"字型",fontsize:"大小",layoutstyle:"配置樣式",node:"節點操作",hand:"允許拖曳",camera:"回到根節點","zoom-in":"放大（Ctrl+）","zoom-out":"縮寫（Ctrl-）",markers:"標記",help:"說明",preference:"喜好設定",expandnode:"展開至末端節點",collapsenode:"收合至第一級節點",template:"範本",theme:"主題",clearstyle:"清除樣式",copystyle:"複製樣式",pastestyle:"貼上樣式",appendsiblingnode:"同層主题",appendchildnode:"下層主题",arrangeup:"上移",arrangedown:"下移",editnode:"編輯",removenode:"移除",priority:"優先順序",progress:{p1:"未開始",p2:"完成 1/8",p3:"完成 1/4",p4:"完成 3/8",p5:"完成一半",p6:"完成 5/8",p7:"完成 3/4",p8:"完成 7/8",p9:"已完成",p0:"清除進度"},resource:{add:"新增"},link:"連結",image:"圖片",note:"備註",insertlink:"插入連結",insertimage:"插入圖片",insertnote:"插入備註",removelink:"移除連結",removeimage:"移除圖片",removenote:"移除備註",resetlayout:"重新配置",navigator:"導覽器",selectall:"全選",selectrevert:"取消全選",selectsiblings:"選取下層節點",selectlevel:"選取同層節點",selectpath:"選取路徑",selecttree:"選取樹系",noteeditor:{title:"標題",hint:"支援 GFM 語法撰寫",placeholder:"請選取節點以編輯備註文字"},dialog:{image:{title:"圖片",imagesearch:"圖片搜尋",keyword:"關鍵字",placeholder:"請輸入要搜尋的關鍵字",baidu:"百度",linkimage:"連結圖片",linkurl:"連結位址",placeholder2:"必填：以 http(s):// 開頭",imagehint:"提示訊息",placeholder3:"選填：當游標在圖片上懸停時顯示的訊息",preview:"圖片預覽",uploadimage:"上傳圖片",selectfile:"選擇檔案...",ok:"確定",cancel:"取消",formatinfo:"附檔名只接受 jpg、gif 及 png"},hyperlink:{title:"連結",linkurl:"連結位址",linkhint:"提示訊息",placeholder:"必填：以 http(s):// 或 ftp(s):// 開頭",placeholder2:"選填：當游標在連結上懸停時顯示的訊息",ok:"確定",cancel:"取消"},exportnode:{title:"匯出節點",ok:"確定",cancel:"取消"}}},runtime:{minder:{maintopic:"中心主題"},node:{arrangeup:"上移",appendchildnode:"下層",appendsiblingnode:"同層",arrangedown:"下移",removenode:"刪除",appendparentnode:"上層",selectall:"全選",topic:"分支主題",importnode:"匯入節點",exportnode:"匯出節點"},input:{edit:"編輯"},priority:{main:"優先權",remove:"移除",esc:"返回"},progress:{main:"進度",remove:"移除",esc:"返回"},history:{undo:"復原",redo:"取消復原"}}}}};var t,n={"expose-editor":1};angular.module("kityminderEditor",["ui.bootstrap","ui.codemirror","ui.colorpicker"]).config(["$sceDelegateProvider",function(e){e.resourceUrlWhitelist(["self","http://agroup.baidu.com:8910/**","http://cq01-fe-rdtest01.vm.baidu.com:8910/**","http://agroup.baidu.com:8911/**"])}]),angular.module("kityminderEditor").run(["$templateCache",function(e){"use strict";e.put("ui/directive/appendNode/appendNode.html","<div class=\"km-btn-group append-group\"><div class=\"km-btn-item append-child-node\" ng-disabled=\"minder.queryCommandState('AppendChildNode') === -1\" ng-click=\"minder.queryCommandState('AppendChildNode') === -1 || execCommand('AppendChildNode')\" title=\"{{ 'appendchildnode' | lang:'ui/command' }}\"><i class=\"km-btn-icon\"></i> <span class=\"km-btn-caption\">{{ 'appendchildnode' | lang:'ui/command' }}</span></div><div class=\"km-btn-item append-parent-node\" ng-disabled=\"minder.queryCommandState('AppendParentNode') === -1\" ng-click=\"minder.queryCommandState('AppendParentNode') === -1 || execCommand('AppendParentNode')\" title=\"{{ 'appendparentnode' | lang:'ui/command' }}\"><i class=\"km-btn-icon\"></i> <span class=\"km-btn-caption\">{{ 'appendparentnode' | lang:'ui/command' }}</span></div><div class=\"km-btn-item append-sibling-node\" ng-disabled=\"minder.queryCommandState('AppendSiblingNode') === -1\" ng-click=\"minder.queryCommandState('AppendSiblingNode') === -1 ||execCommand('AppendSiblingNode')\" title=\"{{ 'appendsiblingnode' | lang:'ui/command' }}\"><i class=\"km-btn-icon\"></i> <span class=\"km-btn-caption\">{{ 'appendsiblingnode' | lang:'ui/command' }}</span></div></div>"),e.put("ui/directive/arrange/arrange.html","<div class=\"km-btn-group arrange-group\"><div class=\"km-btn-item arrange-up\" ng-disabled=\"minder.queryCommandState('ArrangeUp') === -1\" ng-click=\"minder.queryCommandState('ArrangeUp') === -1 || minder.execCommand('ArrangeUp')\" title=\"{{ 'arrangeup' | lang:'ui/command' }}\"><i class=\"km-btn-icon\"></i> <span class=\"km-btn-caption\">{{ 'arrangeup' | lang:'ui/command' }}</span></div><div class=\"km-btn-item arrange-down\" ng-disabled=\"minder.queryCommandState('ArrangeDown') === -1\" ng-click=\"minder.queryCommandState('ArrangeDown') === -1 || minder.execCommand('ArrangeDown');\" title=\"{{ 'arrangedown' | lang:'ui/command' }}\"><i class=\"km-btn-icon\"></i> <span class=\"km-btn-caption\">{{ 'arrangedown' | lang:'ui/command' }}</span></div></div>"),e.put("ui/directive/colorPanel/colorPanel.html",'<div class="bg-color-wrap" title="{{ \'color\' | lang:\'panels\' }}"><span class="quick-bg-color" ng-click="minder.queryCommandState(\'background\') === -1 || minder.execCommand(\'background\', bgColor)" ng-disabled="minder.queryCommandState(\'background\') === -1"></span> <span color-picker class="bg-color" set-color="setDefaultBg()" ng-disabled="minder.queryCommandState(\'background\') === -1"><span class="caret"></span></span> <span class="bg-color-preview" ng-style="{ \'background-color\': bgColor }" ng-click="minder.queryCommandState(\'background\') === -1 || minder.execCommand(\'background\', bgColor)" ng-disabled="minder.queryCommandState(\'background\') === -1"></span></div>'),e.put("ui/directive/expandLevel/expandLevel.html",'<div class="btn-group-vertical" dropdown is-open="isopen"><button type="button" class="btn btn-default expand" title="{{ \'expandtoleaf\' | lang:\'ui\' }}" ng-class="{\'active\': isopen}" ng-click="minder.execCommand(\'ExpandToLevel\', 9999)"></button> <button type="button" class="btn btn-default expand-caption dropdown-toggle" title="{{ \'expandtoleaf\' | lang:\'ui\' }}" dropdown-toggle><span class="caption">{{ \'expandtoleaf\' | lang:\'ui\' }}</span> <span class="caret"></span> <span class="sr-only">{{ \'expandtoleaf\' | lang:\'ui\' }}</span></button><ul class="dropdown-menu" role="menu"><li ng-repeat="level in levels"><a href ng-click="minder.execCommand(\'ExpandToLevel\', level)">{{ \'expandtolevel\' + level | lang:\'ui/command\' }}</a></li></ul></div>'),e.put("ui/directive/fontOperator/fontOperator.html",'<div class="font-operator"><div class="dropdown font-family-list" dropdown><div class="dropdown-toggle current-font-item" dropdown-toggle ng-disabled="minder.queryCommandState(\'fontfamily\') === -1"><a href class="current-font-family" title="{{ \'fontfamily\' | lang: \'ui\' }}">{{ getFontfamilyName(minder.queryCommandValue(\'fontfamily\')) || lang(\'fontfamily\', \'ui\') }}</a> <span class="caret"></span></div><ul class="dropdown-menu font-list"><li ng-repeat="f in fontFamilyList" class="font-item-wrap"><a ng-click="minder.execCommand(\'fontfamily\', f.val)" class="font-item" ng-class="{ \'font-item-selected\' : f == minder.queryCommandValue(\'fontfamily\') }" ng-style="{\'font-family\': f.val }">{{ f.name }}</a></li></ul></div><div class="dropdown font-size-list" dropdown><div class="dropdown-toggle current-font-item" dropdown-toggle ng-disabled="minder.queryCommandState(\'fontsize\') === -1"><a href class="current-font-size" title="{{ \'fontsize\' | lang: \'ui\' }}">{{ minder.queryCommandValue(\'fontsize\') || lang(\'fontsize\', \'ui\') }}</a> <span class="caret"></span></div><ul class="dropdown-menu font-list"><li ng-repeat="f in fontSizeList" class="font-item-wrap"><a ng-click="minder.execCommand(\'fontsize\', f)" class="font-item" ng-class="{ \'font-item-selected\' : f == minder.queryCommandValue(\'fontsize\') }" ng-style="{\'font-size\': f + \'px\'}">{{ f }}</a></li></ul></div><span class="s-btn-icon font-bold" title="{{ \'bold\' | lang: \'ui\' }}" ng-click="minder.queryCommandState(\'bold\') === -1 || minder.execCommand(\'bold\')" ng-class="{\'font-bold-selected\' : minder.queryCommandState(\'bold\') == 1}" ng-disabled="minder.queryCommandState(\'bold\') === -1"></span> <span class="s-btn-icon font-italics" title="{{ \'italic\' | lang: \'ui\' }}" ng-click="minder.queryCommandState(\'italic\') === -1 || minder.execCommand(\'italic\')" ng-class="{\'font-italics-selected\' : minder.queryCommandState(\'italic\') == 1}" ng-disabled="minder.queryCommandState(\'italic\') === -1"></span><div class="font-color-wrap" title="{{ \'forecolor\' | lang: \'ui\'}}"><span class="quick-font-color" ng-click="minder.queryCommandState(\'forecolor\') === -1 || minder.execCommand(\'forecolor\', foreColor)" ng-disabled="minder.queryCommandState(\'forecolor\') === -1">A</span> <span color-picker class="font-color" set-color="setDefaultColor()" ng-disabled="minder.queryCommandState(\'forecolor\') === -1"><span class="caret"></span></span> <span class="font-color-preview" ng-style="{ \'background-color\': foreColor }" ng-click="minder.queryCommandState(\'forecolor\') === -1 || minder.execCommand(\'forecolor\', foreColor)" ng-disabled="minder.queryCommandState(\'forecolor\') === -1"></span></div><color-panel minder="minder" class="inline-directive"></color-panel></div>'),e.put("ui/directive/hyperLink/hyperLink.html",'<div class="btn-group-vertical" dropdown is-open="isopen"><button type="button" class="btn btn-default hyperlink" title="{{ \'link\' | lang:\'ui\' }}" ng-class="{\'active\': isopen}" ng-click="addHyperlink()" ng-disabled="minder.queryCommandState(\'HyperLink\') === -1"></button> <button type="button" class="btn btn-default hyperlink-caption dropdown-toggle" ng-disabled="minder.queryCommandState(\'HyperLink\') === -1" title="{{ \'link\' | lang:\'ui\' }}" dropdown-toggle><span class="caption">{{ \'link\' | lang:\'ui\' }}</span> <span class="caret"></span> <span class="sr-only">{{ \'link\' | lang:\'ui\' }}</span></button><ul class="dropdown-menu" role="menu"><li><a href ng-click="addHyperlink()">{{ \'insertlink\' | lang:\'ui\' }}</a></li><li><a href ng-click="minder.execCommand(\'HyperLink\', null)">{{ \'removelink\' | lang:\'ui\' }}</a></li></ul></div>'),e.put("ui/directive/imageBtn/imageBtn.html",'<div class="btn-group-vertical" dropdown is-open="isopen"><button type="button" class="btn btn-default image-btn" title="{{ \'image\' | lang:\'ui\' }}" ng-class="{\'active\': isopen}" ng-click="addImage()" ng-disabled="minder.queryCommandState(\'Image\') === -1"></button> <button type="button" class="btn btn-default image-btn-caption dropdown-toggle" ng-disabled="minder.queryCommandState(\'Image\') === -1" title="{{ \'image\' | lang:\'ui\' }}" dropdown-toggle><span class="caption">{{ \'image\' | lang:\'ui\' }}</span> <span class="caret"></span> <span class="sr-only">{{ \'image\' | lang:\'ui\' }}</span></button><ul class="dropdown-menu" role="menu"><li><a href ng-click="addImage()">{{ \'insertimage\' | lang:\'ui\' }}</a></li><li><a href ng-click="minder.execCommand(\'Image\', \'\')">{{ \'removeimage\' | lang:\'ui\' }}</a></li></ul></div>'),e.put("ui/directive/kityminderEditor/kityminderEditor.html",'<div class="minder-editor-container"><div class="top-tab" top-tab="minder" editor="editor" ng-if="minder"></div><div search-box minder="minder" ng-if="minder"></div><div class="minder-editor"></div><div class="km-note" note-editor minder="minder" ng-if="minder"></div><div class="note-previewer" note-previewer ng-if="minder"></div><div class="navigator" navigator minder="minder" ng-if="minder"></div></div>'),e.put("ui/directive/kityminderViewer/kityminderViewer.html",'<div class="minder-editor-container"><div class="minder-viewer"></div><div class="note-previewer" note-previewer ng-if="minder"></div><div class="navigator" navigator minder="minder" ng-if="minder"></div></div>'),e.put("ui/directive/layout/layout.html",'<div class="readjust-layout"><a ng-click="minder.queryCommandState(\'resetlayout\') === -1 || minder.execCommand(\'resetlayout\')" class="btn-wrap" ng-disabled="minder.queryCommandState(\'resetlayout\') === -1"><span class="btn-icon reset-layout-icon"></span> <span class="btn-label">{{ \'resetlayout\' | lang: \'ui/command\' }}</span></a></div>'),e.put("ui/directive/navigator/navigator.html",'<div class="nav-bar"><div class="nav-btn zoom-in" ng-click="minder.execCommand(\'zoomIn\')" title="{{ \'zoom-in\' | lang : \'ui\' }}" ng-class="{ \'active\' : getZoomRadio(zoom) == 0 }"><div class="icon"></div></div><div class="zoom-pan"><div class="origin" ng-style="{\'transform\': \'translate(0, \' + getHeight(100) + \'px)\'}" ng-click="minder.execCommand(\'zoom\', 100);"></div><div class="indicator" ng-style="{\n             \'transform\': \'translate(0, \' + getHeight(zoom) + \'px)\',\n             \'transition\': \'transform 200ms\'\n             }"></div></div><div class="nav-btn zoom-out" ng-click="minder.execCommand(\'zoomOut\')" title="{{ \'zoom-out\' | lang : \'ui\' }}" ng-class="{ \'active\' : getZoomRadio(zoom) == 1 }"><div class="icon"></div></div><div class="nav-btn hand" ng-click="minder.execCommand(\'hand\')" title="{{ \'hand\' | lang : \'ui\' }}" ng-class="{ \'active\' : minder.queryCommandState(\'hand\') == 1 }"><div class="icon"></div></div><div class="nav-btn camera" ng-click="minder.execCommand(\'camera\', minder.getRoot(), 600);" title="{{ \'camera\' | lang : \'ui\' }}"><div class="icon"></div></div><div class="nav-btn nav-trigger" ng-class="{\'active\' : isNavOpen}" ng-click="toggleNavOpen()" title="{{ \'navigator\' | lang : \'ui\' }}"><div class="icon"></div></div></div><div class="nav-previewer" ng-show="isNavOpen"></div>'),e.put("ui/directive/noteBtn/noteBtn.html",'<div class="btn-group-vertical note-btn-group" dropdown is-open="isopen"><button type="button" class="btn btn-default note-btn" title="{{ \'note\' | lang:\'ui\' }}" ng-class="{\'active\': isopen}" ng-click="addNote()" ng-disabled="minder.queryCommandState(\'note\') === -1"></button> <button type="button" class="btn btn-default note-btn-caption dropdown-toggle" ng-disabled="minder.queryCommandState(\'note\') === -1" title="{{ \'note\' | lang:\'ui\' }}" dropdown-toggle><span class="caption">{{ \'note\' | lang:\'ui\' }}</span> <span class="caret"></span> <span class="sr-only">{{ \'note\' | lang:\'ui\' }}</span></button><ul class="dropdown-menu" role="menu"><li><a href ng-click="addNote()">{{ \'insertnote\' | lang:\'ui\' }}</a></li><li><a href ng-click="minder.execCommand(\'note\', null)">{{ \'removenote\' | lang:\'ui\' }}</a></li></ul></div>'),e.put("ui/directive/noteEditor/noteEditor.html",'<div class="panel panel-default" ng-init="noteEditorOpen = false" ng-show="noteEditorOpen"><div class="panel-heading"><h3 class="panel-title">{{ \'title\' | lang: \'ui/noteeditor\' }}</h3><span>（<a class="help" href="https://www.zybuluo.com/techird/note/46064" target="_blank">{{ \'hint\' | lang: \'ui/noteeditor\' }}</a>）</span> <i class="close-note-editor glyphicon glyphicon-remove" ng-click="closeNoteEditor()"></i></div><div class="panel-body"><div ng-show="noteEnabled" ui-codemirror="{ onLoad: codemirrorLoaded }" ng-model="noteContent" ui-codemirror-opts="{\n                gfm: true,\n                breaks: true,\n                lineWrapping : true,\n                mode: \'gfm\',\n                dragDrop: false,\n                lineNumbers:true\n             }"></div><p ng-show="!noteEnabled" class="km-note-tips">{{ \'placeholder\' | lang: \'ui/noteeditor\' }}</p></div></div>'),e.put("ui/directive/notePreviewer/notePreviewer.html",'<div id="previewer-content" ng-show="showNotePreviewer" ng-style="previewerStyle" ng-bind-html="noteContent"></div>'),e.put("ui/directive/operation/operation.html","<div class=\"km-btn-group operation-group\"><div class=\"km-btn-item edit-node\" ng-disabled=\"minder.queryCommandState('text') === -1\" ng-click=\"minder.queryCommandState('text') === -1 || editNode()\" title=\"{{ 'editnode' | lang:'ui/command' }}\"><i class=\"km-btn-icon\"></i> <span class=\"km-btn-caption\">{{ 'editnode' | lang:'ui/command' }}</span></div><div class=\"km-btn-item remove-node\" ng-disabled=\"minder.queryCommandState('RemoveNode') === -1\" ng-click=\"minder.queryCommandState('RemoveNode') === -1 || minder.execCommand('RemoveNode');\" title=\"{{ 'removenode' | lang:'ui/command' }}\"><i class=\"km-btn-icon\"></i> <span class=\"km-btn-caption\">{{ 'removenode' | lang:'ui/command' }}</span></div></div>"),e.put("ui/directive/priorityEditor/priorityEditor.html",'<ul class="km-priority tool-group" ng-disabled="commandDisabled"><li class="km-priority-item tool-group-item" ng-repeat="p in priorities" ng-click="commandDisabled || minder.execCommand(\'priority\', p)" ng-class="{ active: commandValue == p }" title="{{ getPriorityTitle(p) }}"><div class="km-priority-icon tool-group-icon priority-{{p}}"></div></li></ul>'),e.put("ui/directive/progressEditor/progressEditor.html",'<ul class="km-progress tool-group" ng-disabled="commandDisabled"><li class="km-progress-item tool-group-item" ng-repeat="p in progresses" ng-click="commandDisabled || minder.execCommand(\'progress\', p)" ng-class="{ active: commandValue == p }" title="{{ getProgressTitle(p) }}"><div class="km-progress-icon tool-group-icon progress-{{p}}"></div></li></ul>'),e.put("ui/directive/resourceEditor/resourceEditor.html",'<div class="resource-editor"><div class="input-group"><input class="form-control" type="text" ng-model="newResourceName" ng-required ng-keypress="$event.keyCode == 13 && addResource(newResourceName)" ng-disabled="!enabled"> <span class="input-group-btn"><button class="btn btn-default" ng-click="addResource(newResourceName)" ng-disabled="!enabled">{{ \'add\' | lang: \'ui/resource\'; }}</button></span></div><div class="resource-dropdown clearfix" id="resource-dropdown"><ul class="km-resource" ng-init="resourceListOpen = false" ng-class="{\'open\': resourceListOpen}"><li ng-repeat="resource in used" ng-disabled="!enabled" ng-blur="blurCB()"><label style="background: {{resourceColor(resource.name)}}"><input type="checkbox" ng-model="resource.selected" ng-disabled="!enabled"> <span>{{resource.name}}</span></label></li></ul><div class="resource-caret" click-anywhere-but-here="resourceListOpen = false" is-active="resourceListOpen" ng-click="resourceListOpen = !resourceListOpen"><span class="caret"></span></div></div></div>'),e.put("ui/directive/searchBox/searchBox.html",'<div id="search" class="search-box clearfix" ng-show="showSearch"><div class="input-group input-group-sm search-input-wrap"><input type="text" id="search-input" class="form-control search-input" ng-model="keyword" ng-keydown="handleKeyDown($event)" aria-describedby="basic-addon2"> <span class="input-group-addon search-addon" id="basic-addon2" ng-show="showTip" ng-bind="\'{{ \'result\' | lang:\'ui/dialog/search\' }}\' + \' \' + curIndex + \' \' + \'{{ \'on\' | lang:\'ui/dialog/search\' }}\' + \' \' +resultNum "></span></div><div class="btn-group btn-group-sm prev-and-next-btn" role="group"><button type="button" class="btn btn-default" ng-click="doSearch(keyword, \'prev\')"><span class="glyphicon glyphicon-chevron-up"></span></button> <button type="button" class="btn btn-default" ng-click="doSearch(keyword, \'next\')"><span class="glyphicon glyphicon-chevron-down"></span></button></div><div class="close-search" ng-click="exitSearch()"><span class="glyphicon glyphicon-remove"></span></div></div>'),e.put("ui/directive/searchBtn/searchBtn.html",'<div class="btn-group-vertical" dropdown is-open="isopen"><button type="button" class="btn btn-default search" title="{{ \'search\' | lang:\'ui\' }}" ng-class="{\'active\': isopen}" ng-click="enterSearch()"></button> <button type="button" class="btn btn-default search-caption dropdown-toggle" ng-click="enterSearch()" title="{{ \'search\' | lang:\'ui\' }}"><span class="caption">{{ \'search\' | lang:\'ui\' }}</span> <span class="sr-only">{{ \'search\' | lang:\'ui\' }}</span></button></div>'),e.put("ui/directive/selectAll/selectAll.html",'<div class="btn-group-vertical" dropdown is-open="isopen"><button type="button" class="btn btn-default select" title="{{ \'selectall\' | lang:\'ui\' }}" ng-class="{\'active\': isopen}" ng-click="select[\'all\']()"></button> <button type="button" class="btn btn-default select-caption dropdown-toggle" title="{{ \'selectall\' | lang:\'ui\' }}" dropdown-toggle><span class="caption">{{ \'selectall\' | lang:\'ui\' }}</span> <span class="caret"></span> <span class="sr-only">{{ \'selectall\' | lang:\'ui\' }}</span></button><ul class="dropdown-menu" role="menu"><li ng-repeat="item in items"><a href ng-click="select[item]()">{{ \'select\' + item | lang:\'ui\' }}</a></li></ul></div>'),e.put("ui/directive/styleOperator/styleOperator.html",'<div class="style-operator"><a ng-click="minder.queryCommandState(\'clearstyle\') === -1 || minder.execCommand(\'clearstyle\')" class="btn-wrap clear-style" ng-disabled="minder.queryCommandState(\'clearstyle\') === -1"><span class="btn-icon clear-style-icon"></span> <span class="btn-label">{{ \'clearstyle\' | lang: \'ui\' }}</span></a><div class="s-btn-group-vertical"><a class="s-btn-wrap" href ng-click="minder.queryCommandState(\'copystyle\') === -1 || minder.execCommand(\'copystyle\')" ng-disabled="minder.queryCommandState(\'copystyle\') === -1"><span class="s-btn-icon copy-style-icon"></span> <span class="s-btn-label">{{ \'copystyle\' | lang: \'ui\' }}</span></a> <a class="s-btn-wrap paste-style-wrap" href ng-click="minder.queryCommandState(\'pastestyle\') === -1 || minder.execCommand(\'pastestyle\')" ng-disabled="minder.queryCommandState(\'pastestyle\') === -1"><span class="s-btn-icon paste-style-icon"></span> <span class="s-btn-label">{{ \'pastestyle\' | lang: \'ui\' }}</span></a></div></div>'),e.put("ui/directive/templateList/templateList.html",'<div class="dropdown temp-panel" dropdown on-toggle="toggled(open)"><div class="dropdown-toggle current-temp-item" ng-disabled="minder.queryCommandState(\'template\') === -1" dropdown-toggle><a href class="temp-item {{ minder.queryCommandValue(\'template\') }}" title="{{ minder.queryCommandValue(\'template\') | lang: \'template\' }}"></a> <span class="caret"></span></div><ul class="dropdown-menu temp-list"><li ng-repeat="(key, templateObj) in templateList" class="temp-item-wrap"><a ng-click="minder.execCommand(\'template\', key);" class="temp-item {{key}}" ng-class="{ \'temp-item-selected\' : key == minder.queryCommandValue(\'template\') }" title="{{ key | lang: \'template\' }}"></a></li></ul></div>'),e.put("ui/directive/themeList/themeList.html",'<div class="dropdown theme-panel" dropdown><div class="dropdown-toggle theme-item-selected" dropdown-toggle ng-disabled="minder.queryCommandState(\'theme\') === -1"><a href class="theme-item" ng-style="getThemeThumbStyle(minder.queryCommandValue(\'theme\'))" title="{{ minder.queryCommandValue(\'theme\') | lang: \'theme\'; }}">{{ minder.queryCommandValue(\'theme\') | lang: \'theme\'; }}</a> <span class="caret"></span></div><ul class="dropdown-menu theme-list"><li ng-repeat="key in themeKeyList" class="theme-item-wrap"><a ng-click="minder.execCommand(\'theme\', key);" class="theme-item" ng-style="getThemeThumbStyle(key)" title="{{ key | lang: \'theme\'; }}">{{ key | lang: \'theme\'; }}</a></li></ul></div>'),e.put("ui/directive/topTab/topTab.html",'<uib-tabset><uib-tab active="true" heading="{{ \'idea\' | lang: \'ui/tabs\'; }}" ng-click="toggleTopTab(\'idea\')" select="setCurTab(\'idea\')"><undo-redo editor="editor"></undo-redo><append-node minder="minder"></append-node><arrange minder="minder"></arrange><operation minder="minder"></operation><hyper-link minder="minder"></hyper-link><image-btn minder="minder"></image-btn><note-btn minder="minder"></note-btn><priority-editor minder="minder"></priority-editor><progress-editor minder="minder"></progress-editor><resource-editor minder="minder"></resource-editor></uib-tab><uib-tab heading="{{ \'appearence\' | lang: \'ui/tabs\'; }}" ng-click="toggleTopTab(\'appearance\')" select="setCurTab(\'appearance\')"><template-list minder="minder" class="inline-directive"></template-list><theme-list minder="minder"></theme-list><layout minder="minder" class="inline-directive"></layout><style-operator minder="minder" class="inline-directive"></style-operator><font-operator minder="minder" class="inline-directive"></font-operator></uib-tab><uib-tab heading="{{ \'view\' | lang: \'ui/tabs\'; }}" ng-click="toggleTopTab(\'view\')" select="setCurTab(\'view\')"><expand-level minder="minder"></expand-level><select-all minder="minder"></select-all><search-btn minder="minder"></search-btn></uib-tab></uib-tabset>'),e.put("ui/directive/undoRedo/undoRedo.html",'<div class="km-btn-group do-group"><div class="km-btn-item undo" ng-disabled="editor.history.hasUndo() == false" ng-click="editor.history.hasUndo() == false || editor.history.undo();" title="{{ \'undo\' | lang:\'ui\' }}"><i class="km-btn-icon"></i></div><div class="km-btn-item redo" ng-disabled="editor.history.hasRedo() == false" ng-click="editor.history.hasRedo() == false || editor.history.redo()" title="{{ \'redo\' | lang:\'ui\' }}"><i class="km-btn-icon"></i></div></div>'),e.put("ui/dialog/hyperlink/hyperlink.tpl.html",'<div class="modal-header"><h3 class="modal-title">{{ \'title\' | lang: \'ui/dialog/hyperlink\'}}</h3></div><div class="modal-body"><form><div class="form-group" id="link-url-wrap" ng-class="{true: \'has-success\', false: \'has-error\'}[urlPassed]"><label for="link-url">{{ \'linkurl\' | lang: \'ui/dialog/hyperlink\'}}</label><input type="text" class="form-control" ng-model="url" ng-blur="urlPassed = R_URL.test(url)" ng-focus="this.value = url" ng-keydown="shortCut($event)" id="link-url" placeholder="{{ \'placeholder\' | lang: \'ui/dialog/hyperlink\'}}"></div><div class="form-group" ng-class="{\'has-success\' : titlePassed}"><label for="link-title">{{ \'linkhint\' | lang: \'ui/dialog/hyperlink\'}}</label><input type="text" class="form-control" ng-model="title" ng-blur="titlePassed = true" id="link-title" placeholder="{{ \'placeholder2\' | lang: \'ui/dialog/hyperlink\'}}"></div></form></div><div class="modal-footer"><button class="btn btn-primary" ng-click="ok()">{{ \'ok\' | lang: \'ui/dialog/hyperlink\'}}</button> <button class="btn btn-warning" ng-click="cancel()">{{ \'cancel\' | lang: \'ui/dialog/hyperlink\'}}</button></div>'),e.put("ui/dialog/imExportNode/imExportNode.tpl.html",'<div class="modal-header"><h3 class="modal-title">{{ title }}</h3></div><div class="modal-body"><textarea type="text" class="form-control single-input" rows="8" ng-keydown="shortCut($event);" ng-model="value" ng-readonly="type === \'export\'">\n    </textarea></div><div class="modal-footer"><button class="btn btn-primary" ng-click="ok()" ng-disabled="type === \'import\' && value == \'\'">{{ \'ok\' | lang: \'ui/dialog/exportnode\'}}</button> <button class="btn btn-warning" ng-click="cancel()">{{ \'cancel\' | lang: \'ui/dialog/exportnode\'}}</button></div>'),e.put("ui/dialog/image/image.tpl.html",'<div class="modal-header"><h3 class="modal-title">{{ \'title\' | lang: \'ui/dialog/image\'}}</h3></div><div class="modal-body"><tabset><tab heading="{{ \'imagesearch\' | lang: \'ui/dialog/image\'}}"><form class="form-inline"><div class="form-group"><label for="search-keyword">{{ \'keyword\' | lang: \'ui/dialog/image\'}}</label><input type="text" class="form-control" ng-model="data.searchKeyword2" id="search-keyword" placeholder="{{ \'placeholder\' | lang: \'ui/dialog/image\'}}"></div><button class="btn btn-primary" ng-click="searchImage()">{{ \'baidu\' | lang: \'ui/dialog/image\'}}</button></form><div class="search-result" id="search-result"><ul><li ng-repeat="image in list" id="{{ \'img-item\' + $index }}" ng-class="{\'selected\' : isSelected}" ng-click="selectImage($event)"><img id="{{ \'img-\' + $index }}" ng-src="{{ image.src || \'\' }}" alt="{{ image.title }}" onerror="this.parentNode.removeChild(this)"> <span>{{ image.title }}</span></li></ul></div></tab><tab heading="{{ \'linkimage\' | lang: \'ui/dialog/image\'}}"><form><div class="form-group" ng-class="{true: \'has-success\', false: \'has-error\'}[urlPassed]"><label for="image-url">{{ \'linkurl\' | lang: \'ui/dialog/image\'}}</label><input type="text" class="form-control" ng-model="data.url" ng-blur="urlPassed = data.R_URL.test(data.url)" ng-focus="this.value = data.url" ng-keydown="shortCut($event)" id="image-url" placeholder="{{ \'placeholder2\' | lang: \'ui/dialog/image\'}}"></div><div class="form-group" ng-class="{\'has-success\' : titlePassed}"><label for="image-title">{{ \'imagehint\' | lang: \'ui/dialog/image\'}}</label><input type="text" class="form-control" ng-model="data.title" ng-blur="titlePassed = true" placeholder="{{ \'placeholder3\' | lang: \'ui/dialog/image\'}}"></div><div class="form-group"><label for="image-preview">{{ \'preview\' | lang: \'ui/dialog/image\'}}</label><img class="image-preview" ng-src="{{ data.url }}" alt="{{ data.title }}"></div></form></tab><tab heading="{{ \'uploadimage\' | lang: \'ui/dialog/image\'}}" active="true"><form><div class="form-group"><input type="file" name="upload-image" id="upload-image" class="upload-image" accept=".jpg,.JPG,jpeg,JPEG,.png,.PNG,.gif,.GIF"><label for="upload-image" class="btn btn-primary"><span>{{ \'selectfile\' | lang: \'ui/dialog/image\'}}</span></label></div><div class="form-group" ng-class="{\'has-success\' : titlePassed}"><label for="image-title">{{ \'imagehint\' | lang: \'ui/dialog/image\'}}</label><input type="text" class="form-control" ng-model="data.title" ng-blur="titlePassed = true" placeholder="{{ \'placeholder3\' | lang: \'ui/dialog/image\'}}"></div><div class="form-group"><label for="image-preview">{{ \'preview\' | lang: \'ui/dialog/image\'}}</label><img class="image-preview" ng-src="{{ data.url }}" title="{{ data.title }}" alt="{{ data.title }}"></div></form></tab></tabset></div><div class="modal-footer"><button class="btn btn-primary" ng-click="ok()">{{ \'ok\' | lang: \'ui/dialog/image\'}}</button> <button class="btn btn-warning" ng-click="cancel()">{{ \'cancel\' | lang: \'ui/dialog/image\'}}</button></div>')}]),angular.module("kityminderEditor").service("commandBinder",function(){return{bind:function(e,t,n){e.on("interactchange",function(){n.commandDisabled=-1===e.queryCommandState(t),n.commandValue=e.queryCommandValue(t),n.$apply()})}}}),angular.module("kityminderEditor").provider("config",function(){this.config={ctrlPanelMin:250,ctrlPanelWidth:parseInt(window.localStorage.__dev_minder_ctrlPanelWidth)||250,dividerWidth:3,lang:"zh_CN",zoom:[10,20,30,50,80,100,120,150,200]},this.set=function(e,t){var n=Object.keys(this.config),i={};for(var r in"object"==typeof e?i=e:i[e]=t,i){if(!i.hasOwnProperty(r)||-1===n.indexOf(r))return console.error("Unsupported config key: ",e,", please choose in :",n.join(", ")),!1;this.config[r]=i[r]}return!0},this.$get=function(){var e=this;return{get:function(t){return 0===arguments.length?e.config:e.config.hasOwnProperty(t)?e.config[t]:(console.warn("Missing config key pair for : ",t),"")}}}}),angular.module("kityminderEditor").service("memory",function(){return{get:function(e){var t=window.localStorage.getItem(e);return JSON.parse(t)},set:function(e,t){try{return window.localStorage.setItem(e,JSON.stringify(t)),!0}catch(e){if(function(e){var t=!1;if(e)if(e.code)switch(e.code){case 22:t=!0;break;case 1014:"NS_ERROR_DOM_QUOTA_REACHED"===e.name&&(t=!0)}else-2147024882===e.number&&(t=!0);return t}(e))return!1}},remove:function(e){var t=window.localStorage.getItem(e);return window.localStorage.removeItem(e),t},clear:function(){window.localStorage.clear()}}}),angular.module("kityminderEditor").service("minder.service",function(){var e=[];return{registerEvent:function(t){e.push(t)},executeCallback:function(){e.forEach(function(e){e.apply(this,arguments)})}}}),angular.module("kityminderEditor").service("resourceService",["$document",function(e){var t=null;this.open=function(r){t||(e.bind("click",n),e.bind("keydown",i)),t&&t!==r&&(t.resourceListOpen=!1),t=r},this.close=function(r){t===r&&(t=null,e.unbind("click",n),e.unbind("keydown",i))};var n=function(e){if(t){var n=t.getToggleElement();e&&n&&n[0].contains(e.target)||t.$apply(function(){console.log("to close the resourcelist"),t.resourceListOpen=!1})}},i=function(e){27===e.which&&(t.focusToggleElement(),n())}}]),angular.module("kityminderEditor").service("revokeDialog",["$uibModal","minder.service",function(e,t){return t.registerEvent(function(){var t=window.minder,n=window.editor,i=n.hotbox.getParentFSM();t.on("importNodeData",function(){i.jump("modal","import-text-modal"),e.open({animation:!0,templateUrl:"ui/dialog/imExportNode/imExportNode.tpl.html",controller:"imExportNode.ctrl",size:"md",resolve:{title:function(){return"导入节点"},defaultValue:function(){return""},type:function(){return"import"}}}).result.then(function(e){try{t.Text2Children(t.getSelectedNode(),e)}catch(e){alert(e)}i.jump("normal","import-text-finish"),n.receiver.selectAll()},function(){i.jump("normal","import-text-finish"),n.receiver.selectAll()})}),t.on("exportNodeData",function(){i.jump("modal","export-text-modal"),e.open({animation:!0,templateUrl:"ui/dialog/imExportNode/imExportNode.tpl.html",controller:"imExportNode.ctrl",size:"md",resolve:{title:function(){return"导出节点"},defaultValue:function(){var e=t.getSelectedNode();return(0,window.kityminder.data.getRegisterProtocol("text").Node2Text)(e)},type:function(){return"export"}}}).result.then(function(e){i.jump("normal","export-text-finish"),n.receiver.selectAll()},function(){i.jump("normal","export-text-finish"),n.receiver.selectAll()})})}),{}}]),angular.module("kityminderEditor").service("valueTransfer",function(){return{}}),angular.module("kityminderEditor").filter("commandState",function(){return function(e,t){return e.queryCommandState(t)}}).filter("commandValue",function(){return function(e,t){return e.queryCommandValue(t)}}),angular.module("kityminderEditor").filter("lang",["config",function(e){return function(t,n){var i=e.get("lang");return window.editor.lang.t(t,n,i)}}]),angular.module("kityminderEditor").controller("hyperlink.ctrl",["$scope","$modalInstance","link",function(e,t,n){e.R_URL=new RegExp("^(?!mailto:)(?:(?:http|https|ftp)://)(?:\\S+(?::\\S*)?@)?(?:(?:(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[0-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z\\u00a1-\\uffff0-9]+-?)*[a-z\\u00a1-\\uffff0-9]+)(?:\\.(?:[a-z\\u00a1-\\uffff0-9]+-?)*[a-z\\u00a1-\\uffff0-9]+)*(?:\\.(?:[a-z\\u00a1-\\uffff]{2,})))|localhost)(?::\\d{2,5})?(?:(/|\\?|#)[^\\s]*)?$","i"),e.url=n.url||"",e.title=n.title||"",setTimeout(function(){var t=$("#link-url");t.focus(),t[0].setSelectionRange(0,e.url.length)},30),e.shortCut=function(t){t.stopPropagation(),13==t.keyCode?e.ok():27==t.keyCode&&e.cancel()},e.ok=function(){if(e.R_URL.test(e.url))t.close({url:e.url,title:e.title});else{e.urlPassed=!1;var n=$("#link-url");n.focus(),n[0].setSelectionRange(0,e.url.length)}editor.receiver.selectAll()},e.cancel=function(){t.dismiss("cancel"),editor.receiver.selectAll()}}]),angular.module("kityminderEditor").controller("imExportNode.ctrl",["$scope","$modalInstance","title","defaultValue","type",function(e,t,n,i,r){e.title=n,e.value=i,e.type=r,e.ok=function(){""!=e.value&&(t.close(e.value),editor.receiver.selectAll())},e.cancel=function(){t.dismiss("cancel"),editor.receiver.selectAll()},setTimeout(function(){$(".single-input").focus(),$(".single-input")[0].setSelectionRange(0,i.length)},30),e.shortCut=function(t){if(t.stopPropagation(),27==t.keyCode&&e.cancel(),8==t.keyCode&&"export"==r&&t.preventDefault(),9==t.keyCode){t.preventDefault();var n=t.target,i=function(e){var t=0;if(document.selection){e.focus();var n=document.selection.createRange();n.moveStart("character",-e.value.length),t=n.text.length}else(e.selectionStart||"0"==e.selectionStart)&&(t=e.selectionStart);return t}(n),o=n.value;n.value=o.substr(0,i)+"\t"+o.substr(i),function(e,t){if(e.setSelectionRange)e.focus(),e.setSelectionRange(t,t);else if(e.createTextRange){var n=e.createTextRange();n.collapse(!0),n.moveEnd("character",t),n.moveStart("character",t),n.select()}}(n,i+1)}}}]),angular.module("kityminderEditor").controller("image.ctrl",["$http","$scope","$modalInstance","image","$filter",function(e,t,n,i,r){t.lang=r("lang"),t.data={list:[],url:i.url||"",title:i.title||"",R_URL:/^(http|https|data)?\:\w+/},setTimeout(function(){var e=$("#image-url");e.focus(),e[0].setSelectionRange(0,t.data.url.length)},300),n.rendered.then(function(){$("#upload-image").change(function(){t.uploadImage()})}),t.searchImage=function(){var n,i,r;t.list=[],(n=t.data.searchKeyword2,i=new Date,r="http://image.baidu.com/search/acjson?tn=resultjson_com&ipn=rj&ct=201326592&fp=result&queryWord="+n+"&cl=2&lm=-1&ie=utf-8&oe=utf-8&st=-1&ic=0&word="+n+"&face=0&istype=2&nc=1&pn=60&rn=60&gsm=3c&"+i.getTime()+"=&callback=JSON_CALLBACK",e.jsonp(r)).success(function(e){if(e&&e.data)for(var n=0;n<e.data.length;n++)e.data[n].objURL&&t.list.push({title:e.data[n].fromPageTitleEnc,src:e.data[n].middleURL,url:e.data[n].middleURL})}).error(function(){})},t.selectImage=function(e){var n=$("#img-item"+this.$index),i=$("#img-"+this.$index);n.siblings(".selected").removeClass("selected"),n.addClass("selected"),t.data.url=i.attr("src"),t.data.title=i.attr("alt")},t.uploadImage=function(){var e=$("#upload-image");if(e.val())if(/^.*\.(jpg|JPG|jpeg|JPEG|gif|GIF|png|PNG)$/.test(e.val())){var n=e[0].files[0],i=new FileReader;i.onload=function(){t.data.url=this.result,t.$apply()},i.readAsDataURL(n)}else alert(lang("formatinfo","ui/dialog/image"))},t.shortCut=function(e){e.stopPropagation(),13==e.keyCode?t.ok():27==e.keyCode&&t.cancel()},t.ok=function(){if(t.data.R_URL.test(t.data.url))n.close({url:t.data.url,title:t.data.title});else{t.urlPassed=!1;var e=$("#image-url");e&&(e.focus(),e[0].setSelectionRange(0,t.data.url.length))}editor.receiver.selectAll()},t.cancel=function(){n.dismiss("cancel"),editor.receiver.selectAll()}}]),angular.module("kityminderEditor").directive("appendNode",["commandBinder",function(e){return{restrict:"E",templateUrl:"ui/directive/appendNode/appendNode.html",scope:{minder:"="},replace:!0,link:function(t){var n=t.minder,i=editor.lang.t;e.bind(n,"appendchildnode",t),t.execCommand=function(e){var t,r,o;n.execCommand(e,i("topic","runtime/node")),t=editor.receiver.element,r=editor.fsm,o=editor.receiver,t.innerText=n.queryCommandValue("text"),r.jump("input","input-request"),o.selectAll()}}}}]),angular.module("kityminderEditor").directive("arrange",["commandBinder",function(e){return{restrict:"E",templateUrl:"ui/directive/arrange/arrange.html",scope:{minder:"="},replace:!0,link:function(e){e.minder}}}]),angular.module("kityminderEditor").directive("colorPanel",function(){return{restrict:"E",templateUrl:"ui/directive/colorPanel/colorPanel.html",scope:{minder:"="},replace:!0,link:function(e){var t=e.minder;t.getThemeItems();e.$on("colorPicked",function(n,i){n.stopPropagation(),e.bgColor=i,t.execCommand("background",i)}),e.setDefaultBg=function(){var e=t.getSelectedNode(),n=t.getNodeStyle(e,"background");return"object"==typeof n?n.toHEX():n},e.bgColor=e.setDefaultBg()||"#fff"}}}),angular.module("kityminderEditor").directive("expandLevel",function(){return{restrict:"E",templateUrl:"ui/directive/expandLevel/expandLevel.html",scope:{minder:"="},replace:!0,link:function(e){e.levels=[1,2,3,4,5,6]}}}),angular.module("kityminderEditor").directive("fontOperator",["$filter",function(e){return{restrict:"E",templateUrl:"ui/directive/fontOperator/fontOperator.html",scope:{minder:"="},replace:!0,link:function(t){var n=t.minder;n.getThemeItems();t.fontSizeList=[10,12,16,18,24,32,48],t.fontFamilyList=[{name:"宋体",val:"宋体,SimSun"},{name:"微软雅黑",val:"微软雅黑,Microsoft YaHei"},{name:"楷体",val:"楷体,楷体_GB2312,SimKai"},{name:"黑体",val:"黑体, SimHei"},{name:"隶书",val:"隶书, SimLi"},{name:"Andale Mono",val:"andale mono"},{name:"Arial",val:"arial,helvetica,sans-serif"},{name:"arialBlack",val:"arial black,avant garde"},{name:"Comic Sans Ms",val:"comic sans ms"},{name:"Impact",val:"impact,chicago"},{name:"Times New Roman",val:"times new roman"},{name:"Sans-Serif",val:"sans-serif"}],t.$on("colorPicked",function(e,i){e.stopPropagation(),t.foreColor=i,n.execCommand("forecolor",i)}),t.setDefaultColor=function(){var e=n.getSelectedNode(),t=n.getNodeStyle(e,"color");return"object"==typeof t?t.toHEX():t},t.foreColor=t.setDefaultColor()||"#000",t.lang=e("lang"),t.getFontfamilyName=function(e){var n="";return t.fontFamilyList.forEach(function(t,i,r){if(t.val===e)return n=t.name,""}),n}}}}]),angular.module("kityminderEditor").directive("hyperLink",["$uibModal",function(e){return{restrict:"E",templateUrl:"ui/directive/hyperLink/hyperLink.html",scope:{minder:"="},replace:!0,link:function(t){var n=t.minder;t.addHyperlink=function(){var t=n.queryCommandValue("HyperLink");e.open({animation:!0,templateUrl:"ui/dialog/hyperlink/hyperlink.tpl.html",controller:"hyperlink.ctrl",size:"md",resolve:{link:function(){return t}}}).result.then(function(e){n.execCommand("HyperLink",e.url,e.title||"")})}}}}]),angular.module("kityminderEditor").directive("imageBtn",["$uibModal",function(e){return{restrict:"E",templateUrl:"ui/directive/imageBtn/imageBtn.html",scope:{minder:"="},replace:!0,link:function(t){var n=t.minder;t.addImage=function(){var t=n.queryCommandValue("image");e.open({animation:!0,templateUrl:"ui/dialog/image/image.tpl.html",controller:"image.ctrl",size:"md",resolve:{image:function(){return t}}}).result.then(function(e){n.execCommand("image",e.url,e.title||"")})}}}}]),angular.module("kityminderEditor").directive("kityminderEditor",["config","minder.service","revokeDialog",function(e,t,n){return{restrict:"EA",templateUrl:"ui/directive/kityminderEditor/kityminderEditor.html",replace:!0,scope:{onInit:"&"},link:function(n,i,r){var o=i.children(".minder-editor")[0];function a(e,i){n.onInit({editor:e,minder:i}),t.executeCallback()}if("undefined"!=typeof seajs)seajs.config({base:"./src"}),define("demo",function(t){var i=t("editor"),r=e.get("lang"),l=window.editor=new i(o,r);window.localStorage.__dev_minder_content&&l.minder.importJson(JSON.parse(window.localStorage.__dev_minder_content)),l.minder.on("contentchange",function(){window.localStorage.__dev_minder_content=JSON.stringify(l.minder.exportJson())}),window.minder=window.km=l.minder,n.editor=l,n.minder=minder,n.config=e.get(),n.$apply(),a(l,minder)}),seajs.use("demo");else if(window.kityminder&&window.kityminder.Editor){var l=e.get("lang"),s=new kityminder.Editor(o,l);window.editor=n.editor=s,window.minder=n.minder=s.minder,n.config=e.get(),a(s,s.minder)}}}}]),angular.module("kityminderEditor").directive("kityminderViewer",["config","minder.service",function(e,t){return{restrict:"EA",templateUrl:"ui/directive/kityminderViewer/kityminderViewer.html",replace:!0,scope:{onInit:"&"},link:function(e,n,i){var r=n.children(".minder-viewer")[0];if(window.kityminder&&window.kityminder.Editor){var o=new kityminder.Editor(r);window.editor=e.editor=o,window.minder=e.minder=o.minder,function(n,i){e.onInit({editor:n,minder:i}),t.executeCallback()}(o,o.minder)}}}}]),angular.module("kityminderEditor").directive("layout",function(){return{restrict:"E",templateUrl:"ui/directive/layout/layout.html",scope:{minder:"="},replace:!0,link:function(e){}}}),angular.module("kityminderEditor").directive("navigator",["memory","config",function(e,t){return{restrict:"A",templateUrl:"ui/directive/navigator/navigator.html",scope:{minder:"="},link:function(n){function i(){minder.on("layout layoutallfinish",g),minder.on("viewchange",f)}function r(){minder.off("layout layoutallfinish",g),minder.off("viewchange",f)}minder.setDefaultOptions({zoom:t.get("zoom")}),n.isNavOpen=!e.get("navigator-hidden"),n.getZoomRadio=function(e){var t=minder.getOption("zoom"),n=t[0];return 1-(e-n)/(t[t.length-1]-n)},n.getHeight=function(e){var t=$(".zoom-pan").height();return n.getZoomRadio(e)*t},n.zoom=100,minder.on("zoom",function(e){n.zoom=e.zoom}),n.toggleNavOpen=function(){n.isNavOpen=!n.isNavOpen,e.set("navigator-hidden",!n.isNavOpen),n.isNavOpen?(i(),g(),f()):r()},setTimeout(function(){n.isNavOpen?(i(),g(),f()):r()},0);var o=$(".nav-previewer"),a=new kity.Paper(o[0]),l=a.put(new kity.Path),s=a.put(new kity.Path),d=a.put(new kity.Rect(100,100).stroke("red","1%")),c=new kity.Box,u=new kity.Box,p=m(minder.getTheme());function m(e){switch(e){case"tianpan":case"tianpan-compact":return function(e,t,n,i,r){var o=i>>1;e.push("M",t,n+o,"a",o,o,0,1,1,0,.01,"z")};default:return function(e,t,n,i,r){e.push("M",t,n,"h",i,"v",r,"h",-i,"z")}}}function g(){var e=minder.getRenderContainer().getBoundaryBox();c=e;a.setViewBox(e.x-30-.5,e.y-30-.5,e.width+60+1,e.height+60+1);var t=[],n=[];minder.getRoot().traverse(function(e){var i=e.getLayoutBox();p(t,i.x,i.y,i.width,i.height),e.getConnection()&&e.parent&&e.parent.isExpanded()&&n.push(e.getConnection().getPathData())}),a.setStyle("background",minder.getStyle("background")),t.length?l.fill(minder.getStyle("root-background")).setPathData(t):l.setPathData(null),n.length?s.stroke(minder.getStyle("connect-color"),"0.5%").setPathData(n):s.setPathData(null),f()}function f(){u=minder.getViewDragger().getView(),d.setBox(u.intersect(c))}minder.on("themechange",function(e){p=m(e.theme)}),function(){function e(e,t){var n=u;e.x=-e.x,e.y=-e.y;var i=minder.getPaper().getViewPortMatrix();n=i.transformBox(n);var r=e.offset(n.width/2,n.height/2);minder.getViewDragger().moveTo(r,t)}var t=!1;a.on("mousedown",function(n){t=!0,e(n.getPosition("top"),200),o.addClass("grab")}),a.on("mousemove",function(n){t&&e(n.getPosition("top"))}),$(window).on("mouseup",function(){t=!1,o.removeClass("grab")})}()}}}]),angular.module("kityminderEditor").directive("noteBtn",["valueTransfer",function(e){return{restrict:"E",templateUrl:"ui/directive/noteBtn/noteBtn.html",scope:{minder:"="},replace:!0,link:function(t){t.minder;t.addNote=function(){e.noteEditorOpen=!0}}}}]),angular.module("kityminderEditor").directive("noteEditor",["valueTransfer",function(e){return{restrict:"A",templateUrl:"ui/directive/noteEditor/noteEditor.html",scope:{minder:"="},replace:!0,controller:["$scope",function(t){var n,i=t.minder,r=!1;t.codemirrorLoaded=function(e){n=t.cmEditor=e,e.setSize("100%","100%")},t.$watch("noteContent",function(e){var t=-1!=i.queryCommandState("note");e&&t&&!r&&i.execCommand("note",e),setTimeout(function(){n.refresh()})});t.$watch(function(){return e.noteEditorOpen},function(i,r){i&&setTimeout(function(){n.refresh(),n.focus()}),t.noteEditorOpen=e.noteEditorOpen},!0),t.closeNoteEditor=function(){e.noteEditorOpen=!1,editor.receiver.selectAll()},i.on("interactchange",function(){var e=t.noteEnabled=-1!=i.queryCommandState("note"),n=i.queryCommandValue("note")||"";e&&(t.noteContent=n),r=!0,t.$apply(),r=!1})}]}}]),angular.module("kityminderEditor").directive("notePreviewer",["$sce","valueTransfer",function(e,t){return{restrict:"A",templateUrl:"ui/directive/notePreviewer/notePreviewer.html",link:function(t,n){var i,r=t.minder,o=n.parent(),a=n.children();t.showNotePreviewer=!1,marked.setOptions({gfm:!0,tables:!0,breaks:!0,pedantic:!1,sanitize:!0,smartLists:!0,smartypants:!1}),r.on("shownoterequest",function(n){i=setTimeout(function(){!function(n,i){var r=n.getRenderer("NoteIconRenderer").getRenderShape().getRenderBox("screen"),s=n.getData("note");a[0].scrollTop=0;var d=marked(s);i&&(d=d.replace(new RegExp("("+i+")","ig"),'<span class="highlight">$1</span>'));t.noteContent=e.trustAsHtml(d),t.$apply();var c=$(o[0]).width(),u=$(o[0]).height(),p=$(a).outerWidth(),m=$(a).outerHeight(),g=r.cx-p/2-o[0].offsetLeft,f=r.bottom+10-o[0].offsetTop;g<0&&(g=10);g+p>c&&(g=r.left-p-10-o[0].offsetLeft);f+m>u&&(f=r.top-m-10-o[0].offsetTop);t.previewerStyle={left:Math.round(g)+"px",top:Math.round(f)+"px"},t.showNotePreviewer=!0;var h=a[0].querySelector(".highlight");h&&h.scrollIntoView();l=!0,t.$apply()}(n.node,n.keyword)},300)}),r.on("hidenoterequest",function(){clearTimeout(i),t.showNotePreviewer=!1});var l=!1;$(document).on("mousedown mousewheel DOMMouseScroll",function(){l&&(t.showNotePreviewer=!1,t.$apply())}),n.on("mousedown mousewheel DOMMouseScroll",function(e){e.stopPropagation()})}}}]),angular.module("kityminderEditor").directive("operation",function(){return{restrict:"E",templateUrl:"ui/directive/operation/operation.html",scope:{minder:"="},replace:!0,link:function(e){e.editNode=function(){var e=editor.receiver.element,t=editor.fsm,n=editor.receiver;e.innerText=minder.queryCommandValue("text"),t.jump("input","input-request"),n.selectAll()}}}}),angular.module("kityminderEditor").directive("priorityEditor",["commandBinder",function(e){return{restrict:"E",templateUrl:"ui/directive/priorityEditor/priorityEditor.html",scope:{minder:"="},replace:!0,link:function(t){for(var n=t.minder,i=editor.lang.t,r=[],o=0;o<10;o++)r.push(o);e.bind(n,"priority",t),t.priorities=r,t.getPriorityTitle=function(e){switch(e){case 0:return i("no priority","ui");default:return i("priority","ui")+" "+e}}}}}]),angular.module("kityminderEditor").directive("progressEditor",["commandBinder",function(e){return{restrict:"E",templateUrl:"ui/directive/progressEditor/progressEditor.html",scope:{minder:"="},replace:!0,link:function(t){for(var n=t.minder,i=editor.lang.t,r=[],o=0;o<10;o++)r.push(o);e.bind(n,"progress",t),t.progresses=r,t.getProgressTitle=function(e){return i("p"+e,"ui/progress")}}}}]),angular.module("kityminderEditor").directive("resourceEditor",function(){return{restrict:"E",templateUrl:"ui/directive/resourceEditor/resourceEditor.html",scope:{minder:"="},replace:!0,controller:["$scope",function(e){var t=e.minder,n=!1;t.on("interactchange",function(){var i=(e.enabled=-1!=t.queryCommandState("resource"))?t.queryCommandValue("resource"):[],r=t.getUsedResource().map(function(e){return{name:e,selected:i.indexOf(e)>-1}});e.used=r,n=!0,e.$apply(),n=!1}),e.$watch("used",function(e){if(-1!=t.queryCommandState("resource")&&e){var i=e.filter(function(e){return e.selected}).map(function(e){return e.name});if(n)return;t.execCommand("resource",i)}},!0),e.resourceColor=function(e){return t.getResourceColor(e).toHEX()},e.addResource=function(n){var i=t.queryCommandValue("resource");n&&/\S/.test(n)&&(-1==i.indexOf(n)&&e.used.push({name:n,selected:!0}),e.newResourceName=null)}}]}}).directive("clickAnywhereButHere",["$document",function(e){return{link:function(t,n,i){var r=function(e){var n=$("#resource-dropdown").has(e.target).length>0,r=$("#resource-dropdown")==e.target;n||r||t.$apply(i.clickAnywhereButHere)};t.$watch(i.isActive,function(t,n){t!==n&&1==t?e.bind("click",r):t!==n&&0==t&&e.unbind("click",r)})}}}]),angular.module("kityminderEditor").directive("searchBox",function(){return{restrict:"A",templateUrl:"ui/directive/searchBox/searchBox.html",scope:{minder:"="},replace:!0,controller:["$scope",function(e){var t=e.minder,n=window.editor;function i(){$("#search-input").blur(),e.showSearch=!1,t.fire("hidenoterequest"),n.receiver.selectAll()}function r(){e.showSearch=!0,setTimeout(function(){$("#search-input").focus()},10),e.keyword&&$("#search-input")[0].setSelectionRange(0,e.keyword.length)}e.handleKeyDown=function(t){if(13==t.keyCode){var n=t.shiftKey?"prev":"next";s(e.keyword,n)}27==t.keyCode&&i()},e.doSearch=s,e.exitSearch=i,e.showTip=!1,e.showSearch=!1,$("body").on("keydown",function(t){70!=t.keyCode||!t.ctrlKey&&!t.metaKey||t.shiftKey||(r(),e.$apply(),t.preventDefault())}),t.on("searchNode",function(){r()});var o=[],a=[];function l(){o=[],t.getRoot().traverse(function(e){o.push(e)})}function s(n,i){if(e.showTip=!1,t.fire("hidenoterequest"),n&&/\S/.exec(n)){e.showTip=!0,e.curIndex=0,e.resultNum=0,n=n.toLowerCase();var r,l,d=s.lastKeyword!=n;if(s.lastKeyword=n,d&&function(e){a=[];for(var t=0;t<o.length;t++){var n=o[t];-1!=n.getText().toLowerCase().indexOf(e)&&a.push({node:n});var i=n.getData("note");i&&-1!=i.toLowerCase().indexOf(e)&&a.push({node:n,keyword:e})}}(n),e.resultNum=a.length,a.length){var c=d?0:("next"===i?s.lastIndex+1:s.lastIndex-1)||0;c=(a.length+c)%a.length,r=a[c].node,l=a[c].keyword,t.execCommand("camera",r,50),setTimeout(function(){t.select(r,!0),r.isExpanded()||t.execCommand("expand",!0),l&&t.fire("shownoterequest",{node:r,keyword:l})},60),s.lastIndex=c,e.curIndex=c+1}}else $("#search-input").focus()}t.on("contentchange",l),l()}]}}),angular.module("kityminderEditor").directive("searchBtn",function(){return{restrict:"E",templateUrl:"ui/directive/searchBtn/searchBtn.html",scope:{minder:"="},replace:!0,link:function(e){e.enterSearch=function(){minder.fire("searchNode")}}}}),angular.module("kityminderEditor").directive("selectAll",function(){return{restrict:"E",templateUrl:"ui/directive/selectAll/selectAll.html",scope:{minder:"="},replace:!0,link:function(e){var t=e.minder;e.items=["revert","siblings","level","path","tree"],e.select={all:function(){var e=[];t.getRoot().traverse(function(t){e.push(t)}),t.select(e,!0),t.fire("receiverfocus")},revert:function(){var e=t.getSelectedNodes(),n=[];t.getRoot().traverse(function(t){-1==e.indexOf(t)&&n.push(t)}),t.select(n,!0),t.fire("receiverfocus")},siblings:function(){var e=t.getSelectedNodes(),n=[];e.forEach(function(e){e.parent&&e.parent.children.forEach(function(e){-1==n.indexOf(e)&&n.push(e)})}),t.select(n,!0),t.fire("receiverfocus")},level:function(){var e=t.getSelectedNodes().map(function(e){return e.getLevel()}),n=[];t.getRoot().traverse(function(t){-1!=e.indexOf(t.getLevel())&&n.push(t)}),t.select(n,!0),t.fire("receiverfocus")},path:function(){var e=t.getSelectedNodes(),n=[];e.forEach(function(e){for(;e&&-1==n.indexOf(e);)n.push(e),e=e.parent}),t.select(n,!0),t.fire("receiverfocus")},tree:function(){var e=t.getSelectedNodes(),n=[];e.forEach(function(e){e.traverse(function(e){-1==n.indexOf(e)&&n.push(e)})}),t.select(n,!0),t.fire("receiverfocus")}}}}}),angular.module("kityminderEditor").directive("styleOperator",function(){return{restrict:"E",templateUrl:"ui/directive/styleOperator/styleOperator.html",scope:{minder:"="},replace:!0}}),angular.module("kityminderEditor").directive("templateList",function(){return{restrict:"E",templateUrl:"ui/directive/templateList/templateList.html",scope:{minder:"="},replace:!0,link:function(e){e.templateList=kityminder.Minder.getTemplateList()}}}),angular.module("kityminderEditor").directive("themeList",function(){return{restrict:"E",templateUrl:"ui/directive/themeList/themeList.html",replace:!0,link:function(e){var t=kityminder.Minder.getThemeList();e.getThemeThumbStyle=function(e){var n=t[e];if(n){var i={color:n["root-color"],"border-radius":n["root-radius"]/2};return n["root-background"]&&(i.background=n["root-background"].toString()),i}},e.themeKeyList=["classic","classic-compact","fresh-blue","fresh-blue-compat","fresh-green","fresh-green-compat","fresh-pink","fresh-pink-compat","fresh-purple","fresh-purple-compat","fresh-red","fresh-red-compat","fresh-soil","fresh-soil-compat","snow","snow-compact","tianpan","tianpan-compact","fish","wire"]}}}),angular.module("kityminderEditor").directive("topTab",function(){return{restrict:"A",templateUrl:"ui/directive/topTab/topTab.html",scope:{minder:"=topTab",editor:"="},link:function(e){var t=!1,n=!0,i=!0;e.setCurTab=function(e){setTimeout(function(){t=!0,"idea"!=e&&(n=!1)})},e.toggleTopTab=function(){setTimeout(function(){var e,r;t&&!n||(n=!1,i?(e=$(".tab-content"),r=$(".minder-editor"),e.animate({height:0,display:"none"}),r.animate({top:"32px"})):function(){var e=$(".tab-content"),t=$(".minder-editor");e.animate({height:"60px",display:"block"}),t.animate({top:"92px"})}(),i=!i),t=!1})}}}}),angular.module("kityminderEditor").directive("undoRedo",function(){return{restrict:"E",templateUrl:"ui/directive/undoRedo/undoRedo.html",scope:{editor:"="},replace:!0,link:function(e){}}}),t="expose-editor",e.r([n[t]])}();
